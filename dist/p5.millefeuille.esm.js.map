{"version":3,"file":"p5.millefeuille.esm.js","sources":["../src/constants.js","../src/Layer.js","../src/Compositor.js","../src/utils/alphaBounds.js","../src/LayerUI.js","../src/LayerSystem.js","../src/index.js"],"sourcesContent":["/**\n * Blend mode constants for layer compositing\n * These map to glsl-blend functions in the compositor shader\n */\nexport const BlendModes = {\n  NORMAL: 'NORMAL',\n  MULTIPLY: 'MULTIPLY',\n  SCREEN: 'SCREEN',\n  ADD: 'ADD',\n  SUBTRACT: 'SUBTRACT',\n  OVERLAY: 'OVERLAY',\n  SOFT_LIGHT: 'SOFT_LIGHT',\n  HARD_LIGHT: 'HARD_LIGHT',\n  COLOR_DODGE: 'COLOR_DODGE',\n  COLOR_BURN: 'COLOR_BURN',\n  DARKEN: 'DARKEN',\n  LIGHTEN: 'LIGHTEN',\n  DIFFERENCE: 'DIFFERENCE',\n  EXCLUSION: 'EXCLUSION'\n};\n\n/**\n * Maps our blend modes to shader uniform integers\n * These correspond to the blend mode indices in compositor.frag\n */\nexport function getBlendModeIndex(mode) {\n  switch (mode) {\n    case BlendModes.NORMAL:\n      return 0;\n    case BlendModes.MULTIPLY:\n      return 1;\n    case BlendModes.SCREEN:\n      return 2;\n    case BlendModes.ADD:\n      return 3;\n    case BlendModes.SUBTRACT:\n      return 4;\n    case BlendModes.OVERLAY:\n      return 5;\n    case BlendModes.SOFT_LIGHT:\n      return 6;\n    case BlendModes.HARD_LIGHT:\n      return 7;\n    case BlendModes.COLOR_DODGE:\n      return 8;\n    case BlendModes.COLOR_BURN:\n      return 9;\n    case BlendModes.DARKEN:\n      return 10;\n    case BlendModes.LIGHTEN:\n      return 11;\n    case BlendModes.DIFFERENCE:\n      return 12;\n    case BlendModes.EXCLUSION:\n      return 13;\n    default:\n      console.warn(`Unknown blend mode: ${mode}, falling back to NORMAL`);\n      return 0;\n  }\n}\n\n/**\n * Default layer options\n */\nexport const DEFAULT_LAYER_OPTIONS = {\n  visible: true,\n  opacity: 1.0,\n  blendMode: BlendModes.NORMAL,\n  width: null,  // null means use canvas width\n  height: null, // null means use canvas height\n  density: null, // null means use canvas density\n  depth: false,\n  antialias: false\n};\n","import { BlendModes, DEFAULT_LAYER_OPTIONS } from './constants.js';\n\n/**\n * Represents a single layer backed by a p5.Framebuffer\n */\nexport class Layer {\n  /**\n   * @param {p5} p5Instance - The p5.js instance\n   * @param {string|number} id - Unique identifier for this layer\n   * @param {string} name - Human-readable name for this layer\n   * @param {Object} options - Layer configuration options\n   */\n  constructor(p5Instance, id, name = '', options = {}) {\n    this.p = p5Instance;\n    this.id = id;\n    this.name = name || `Layer ${id}`;\n\n    // Merge with defaults\n    const opts = { ...DEFAULT_LAYER_OPTIONS, ...options };\n\n    this.visible = opts.visible;\n    this.opacity = this._clampOpacity(opts.opacity);\n    this.blendMode = opts.blendMode;\n    this.zIndex = opts.zIndex !== undefined ? opts.zIndex : id;\n\n    // Framebuffer options\n    this.width = opts.width ?? this.p.width;\n    this.height = opts.height ?? this.p.height;\n    this.density = opts.density ?? this.p.pixelDensity();\n    this.depth = opts.depth;\n    this.antialias = opts.antialias;\n\n    // Flag layers that opted into custom sizing to protect them from auto-resize\n    this.customSize = opts.width != null ||\n      opts.height != null ||\n      opts.density != null;\n\n    // Mask reference (can be p5.Framebuffer or p5.Image)\n    this.mask = null;\n\n    // Track if layer has been drawn to at least once\n    this.hasBeenDrawnTo = false;\n\n    // Create the framebuffer\n    this.framebuffer = this._createFramebuffer();\n\n    if (!this.framebuffer) {\n      throw new Error(`Failed to create framebuffer for layer ${this.name}`);\n    }\n  }\n\n  /**\n   * Creates the underlying p5.Framebuffer\n   * @private\n   */\n  _createFramebuffer() {\n    try {\n      const options = {\n        width: this.width,\n        height: this.height,\n        density: this.density\n      };\n\n      // Only add depth and antialias if explicitly set\n      if (this.depth !== undefined) {\n        options.depth = this.depth;\n      }\n      if (this.antialias !== undefined) {\n        options.antialias = this.antialias;\n      }\n\n      return this.p.createFramebuffer(options);\n    } catch (e) {\n      console.error(`Error creating framebuffer for layer ${this.name}:`, e);\n      return null;\n    }\n  }\n\n  /**\n   * Clamps opacity value to valid range [0, 1]\n   * @private\n   */\n  _clampOpacity(value) {\n    return Math.max(0, Math.min(1, value));\n  }\n\n  /**\n   * Shows this layer (makes it visible)\n   * @returns {Layer} This layer for chaining\n   */\n  show() {\n    this.visible = true;\n    return this;\n  }\n\n  /**\n   * Hides this layer (makes it invisible)\n   * @returns {Layer} This layer for chaining\n   */\n  hide() {\n    this.visible = false;\n    return this;\n  }\n\n  /**\n   * Sets the opacity of this layer\n   * @param {number} opacity - Opacity value between 0 and 1\n   * @returns {Layer} This layer for chaining\n   */\n  setOpacity(opacity) {\n    this.opacity = this._clampOpacity(opacity);\n    return this;\n  }\n\n  /**\n   * Sets the blend mode for this layer\n   * @param {string} mode - One of the BlendModes constants\n   * @returns {Layer} This layer for chaining\n   */\n  setBlendMode(mode) {\n    if (!Object.values(BlendModes).includes(mode)) {\n      console.warn(`Invalid blend mode: ${mode}, using NORMAL`);\n      this.blendMode = BlendModes.NORMAL;\n    } else {\n      this.blendMode = mode;\n    }\n    return this;\n  }\n\n  /**\n   * Sets the z-index (layer order) for this layer\n   * @param {number} zIndex - The z-index value (higher = on top)\n   * @returns {Layer} This layer for chaining\n   */\n  setZIndex(zIndex) {\n    this.zIndex = zIndex;\n    return this;\n  }\n\n  /**\n   * Attaches a mask to this layer\n   * @param {p5.Framebuffer|p5.Image} maskSource - The mask to apply\n   * @returns {Layer} This layer for chaining\n   */\n  setMask(maskSource) {\n    if (!maskSource) {\n      console.warn('Invalid mask source provided');\n      return this;\n    }\n    this.mask = maskSource;\n    return this;\n  }\n\n  /**\n   * Removes the mask from this layer\n   * @returns {Layer} This layer for chaining\n   */\n  clearMask() {\n    this.mask = null;\n    return this;\n  }\n\n  /**\n   * Resizes the layer's framebuffer\n   * @param {number} width - New width\n   * @param {number} height - New height\n   */\n  resize(width, height, density = this.density) {\n    this.width = width;\n    this.height = height;\n    this.density = density;\n\n    // Keep track of whether the layer is canvas-synced or intentionally customized\n    const matchesCanvas = width === this.p.width &&\n      height === this.p.height &&\n      density === this.p.pixelDensity();\n    this.customSize = !matchesCanvas;\n\n    // Dispose old framebuffer\n    if (this.framebuffer) {\n      this.framebuffer.remove();\n    }\n\n    // Create new framebuffer with updated size\n    this.framebuffer = this._createFramebuffer();\n  }\n\n  /**\n   * Begins drawing to this layer's framebuffer\n   */\n  begin() {\n    if (!this.framebuffer) {\n      console.error(`Cannot begin drawing: framebuffer not initialized for layer ${this.name}`);\n      return;\n    }\n    this.framebuffer.begin();\n  }\n\n  /**\n   * Ends drawing to this layer's framebuffer\n   */\n  end() {\n    if (!this.framebuffer) {\n      console.error(`Cannot end drawing: framebuffer not initialized for layer ${this.name}`);\n      return;\n    }\n    this.framebuffer.end();\n    \n    // Mark that this layer has been drawn to\n    this.hasBeenDrawnTo = true;\n  }\n\n  /**\n   * Disposes of this layer's resources\n   */\n  dispose() {\n    if (this.framebuffer) {\n      this.framebuffer.remove();\n      this.framebuffer = null;\n    }\n  }\n\n  /**\n   * Returns a plain object representation of this layer's properties\n   */\n  toJSON() {\n    return {\n      id: this.id,\n      name: this.name,\n      visible: this.visible,\n      opacity: this.opacity,\n      blendMode: this.blendMode,\n      zIndex: this.zIndex,\n      hasMask: !!this.mask,\n      hasBeenDrawnTo: this.hasBeenDrawnTo,\n      width: this.width,\n      height: this.height,\n      density: this.density,\n      customSize: this.customSize\n    };\n  }\n}\n","import { getBlendModeIndex } from './constants.js';\nimport compositorVertSource from './shaders/compositor.vert';\nimport compositorFragSource from './shaders/compositor.frag';\n\n/**\n * Handles the compositing of layers to the main canvas\n */\nexport class Compositor {\n  /**\n   * @param {p5} p5Instance - The p5.js instance\n   */\n  constructor(p5Instance) {\n    this.p = p5Instance;\n    this.shader = null;\n    this.shaderLoaded = false;\n    this.bufferA = null;\n    this.bufferB = null;\n    this._bufferDensity = null;\n  }\n\n  /**\n   * Lazily creates the compositor shader\n   * @private\n   */\n  _ensureShader() {\n    if (!this.shaderLoaded) {\n      try {\n        this.shader = this.p.createShader(compositorVertSource, compositorFragSource);\n        this.shaderLoaded = true;\n      } catch (e) {\n        console.error('Failed to create compositor shader:', e);\n        this.shaderLoaded = false;\n      }\n    }\n    return this.shader;\n  }\n\n  /**\n   * Ensures the ping-pong buffers exist and match canvas size\n   * @private\n   */\n  _ensureBuffers() {\n    const p = this.p;\n    \n    const currentDensity = p.pixelDensity();\n    const needsResize = !this.bufferA || \n              this.bufferA.width !== p.width || \n              this.bufferA.height !== p.height ||\n              this._bufferDensity !== currentDensity;\n    \n    if (needsResize) {\n      if (this.bufferA) {\n        this.bufferA.remove();\n        this.bufferB.remove();\n      }\n      \n      const bufferOptions = {\n        width: p.width,\n        height: p.height,\n        density: currentDensity,\n        antialias: false,\n        depth: false\n      };\n      \n      this.bufferA = p.createFramebuffer(bufferOptions);\n      this.bufferB = p.createFramebuffer(bufferOptions);\n      this._bufferDensity = currentDensity;\n    }\n    \n    return { a: this.bufferA, b: this.bufferB };\n  }\n\n  /**\n   * Renders a single layer to the current framebuffer\n   * @param {Layer} layer - The layer to render\n   * @param {p5.Framebuffer} backgroundBuffer - The background to composite onto\n   * @private\n   */\n  _renderLayer(layer, backgroundBuffer) {\n    if (!layer.visible || layer.opacity <= 0) {\n      return;\n    }\n\n    if (!layer.framebuffer) {\n      console.warn(`Layer ${layer.name} has no framebuffer, skipping`);\n      return;\n    }\n\n    const shader = this._ensureShader();\n    if (!shader) {\n      console.warn('Compositor shader not available, skipping layer');\n      return;\n    }\n\n    const p = this.p;\n\n    // Save current state\n    p.push();\n\n    // Use normal blending since we're doing the blend in the shader\n    p.blendMode(p.BLEND);\n\n    // Use the compositor shader\n    p.shader(shader);\n\n    // Set uniforms\n    shader.setUniform('layerTexture', layer.framebuffer);\n    shader.setUniform('backgroundTexture', backgroundBuffer);\n    shader.setUniform('maskTexture', layer.mask || layer.framebuffer);\n    shader.setUniform('hasMask', layer.mask ? true : false);\n    shader.setUniform('layerOpacity', layer.opacity);\n    shader.setUniform('blendMode', getBlendModeIndex(layer.blendMode));\n\n    // Draw a full-screen quad\n    p.imageMode(p.CENTER);\n    p.rectMode(p.CENTER);\n    p.noStroke();\n    p.fill(255);\n    p.rect(0, 0, p.width, p.height);\n\n    // Reset shader\n    p.resetShader();\n\n    // Restore state\n    p.pop();\n  }\n\n  /**\n   * Composites all layers to the main canvas using ping-pong buffering\n   * @param {Layer[]} layers - Array of layers to composite (should be pre-sorted by zIndex)\n   * @param {Function} clearCallback - Optional callback to clear the canvas before compositing\n   */\n  render(layers, clearCallback = null) {\n    const p = this.p;\n\n    // Ensure we have ping-pong buffers\n    const buffers = this._ensureBuffers();\n    let currentBuffer = buffers.a;\n    let nextBuffer = buffers.b;\n\n    // Sort layers by zIndex (ascending)\n    const sortedLayers = [...layers].sort((a, b) => a.zIndex - b.zIndex);\n\n    // Clear the first buffer\n    currentBuffer.begin();\n    p.clear();\n    currentBuffer.end();\n\n    // Render each layer progressively, ping-ponging between buffers\n    for (let i = 0; i < sortedLayers.length; i++) {\n      const layer = sortedLayers[i];\n      \n      if (!layer.visible || layer.opacity <= 0) {\n        continue;\n      }\n\n      // Render this layer on top of currentBuffer into nextBuffer\n      nextBuffer.begin();\n      p.clear();\n      this._renderLayer(layer, currentBuffer);\n      nextBuffer.end();\n\n      // Swap buffers\n      const temp = currentBuffer;\n      currentBuffer = nextBuffer;\n      nextBuffer = temp;\n    }\n\n    // Now render the final result to the main canvas\n    p.push();\n\n    // Clear the canvas if callback provided\n    if (clearCallback) {\n      clearCallback();\n    } else {\n      p.clear();\n    }\n\n    // Reset to default state\n    p.resetShader();\n    p.blendMode(p.BLEND);\n\n    // Draw the accumulated result to the main canvas\n    p.imageMode(p.CENTER);\n    p.image(currentBuffer, 0, 0);\n\n    p.pop();\n  }\n\n  /**\n   * Disposes of compositor resources\n   */\n  dispose() {\n    // Clean up ping-pong buffers\n    if (this.bufferA) {\n      this.bufferA.remove();\n      this.bufferA = null;\n    }\n    if (this.bufferB) {\n      this.bufferB.remove();\n      this.bufferB = null;\n    }\n    this._bufferDensity = null;\n    \n    // p5.js doesn't have explicit shader disposal, but we can clear the reference\n    this.shader = null;\n    this.shaderLoaded = false;\n  }\n}\n","/**\n * Computes the tightest bounds that contain all pixels whose alpha exceeds the given threshold.\n * @param {Uint8ClampedArray} pixels - RGBA pixel data.\n * @param {number} width - Image width in pixels.\n * @param {number} height - Image height in pixels.\n * @param {Object} [options]\n * @param {number} [options.alphaThreshold=8] - Minimum alpha required to treat a pixel as visible.\n * @param {number} [options.stride=1] - Number of pixels to skip per step when scanning.\n * @returns {{x:number,y:number,width:number,height:number}|null}\n */\nexport function computeAlphaBounds(pixels, width, height, options = {}) {\n  const threshold = Number.isFinite(options.alphaThreshold) ? options.alphaThreshold : 8;\n  const stride = Number.isFinite(options.stride) && options.stride > 0 ? Math.floor(options.stride) : 1;\n\n  let minX = width;\n  let minY = height;\n  let maxX = -1;\n  let maxY = -1;\n\n  for (let y = 0; y < height; y += stride) {\n    const rowOffset = y * width * 4;\n    for (let x = 0; x < width; x += stride) {\n      const idx = rowOffset + x * 4;\n      if (pixels[idx + 3] > threshold) {\n        if (x < minX) minX = x;\n        if (y < minY) minY = y;\n        if (x > maxX) maxX = x;\n        if (y > maxY) maxY = y;\n      }\n    }\n  }\n\n  if (maxX === -1 || maxY === -1) {\n    return null;\n  }\n\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX + 1,\n    height: maxY - minY + 1\n  };\n}\n\n/**\n * Merges multiple bounds objects into their combined extents.\n * @param {Array<{x:number,y:number,width:number,height:number}|null>} boundsList\n * @returns {{x:number,y:number,width:number,height:number}|null}\n */\nexport function mergeBounds(boundsList) {\n  if (!Array.isArray(boundsList) || boundsList.length === 0) {\n    return null;\n  }\n\n  let minX = Number.POSITIVE_INFINITY;\n  let minY = Number.POSITIVE_INFINITY;\n  let maxX = Number.NEGATIVE_INFINITY;\n  let maxY = Number.NEGATIVE_INFINITY;\n  let found = false;\n\n  for (const bounds of boundsList) {\n    if (!bounds) {\n      continue;\n    }\n    found = true;\n    if (bounds.x < minX) minX = bounds.x;\n    if (bounds.y < minY) minY = bounds.y;\n    if (bounds.x + bounds.width > maxX) maxX = bounds.x + bounds.width;\n    if (bounds.y + bounds.height > maxY) maxY = bounds.y + bounds.height;\n  }\n\n  if (!found) {\n    return null;\n  }\n\n  return {\n    x: minX,\n    y: minY,\n    width: Math.max(0, maxX - minX),\n    height: Math.max(0, maxY - minY)\n  };\n}\n\n/**\n * Ensures bounds stay inside the provided limits.\n * @param {{x:number,y:number,width:number,height:number}|null} bounds\n * @param {number} maxWidth\n * @param {number} maxHeight\n * @returns {{x:number,y:number,width:number,height:number}|null}\n */\nexport function clampBounds(bounds, maxWidth, maxHeight) {\n  if (!bounds) {\n    return null;\n  }\n\n  const x = Math.max(0, Math.min(bounds.x, maxWidth));\n  const y = Math.max(0, Math.min(bounds.y, maxHeight));\n  const width = Math.max(0, Math.min(bounds.width, maxWidth - x));\n  const height = Math.max(0, Math.min(bounds.height, maxHeight - y));\n\n  return { x, y, width, height };\n}\n\n/**\n * Expands bounds by padding while clamping to limits.\n * @param {{x:number,y:number,width:number,height:number}|null} bounds\n * @param {number} padding\n * @param {number} maxWidth\n * @param {number} maxHeight\n * @returns {{x:number,y:number,width:number,height:number}|null}\n */\nexport function padBounds(bounds, padding, maxWidth, maxHeight) {\n  if (!bounds) {\n    return null;\n  }\n  const padded = {\n    x: bounds.x - padding,\n    y: bounds.y - padding,\n    width: bounds.width + padding * 2,\n    height: bounds.height + padding * 2\n  };\n  return clampBounds(padded, maxWidth, maxHeight);\n}\n","import { BlendModes } from './constants.js';\nimport { computeAlphaBounds, mergeBounds, padBounds } from './utils/alphaBounds.js';\n\n/**\n * LayerUI - A visual panel for displaying and controlling layers\n */\nexport class LayerUI {\n  /**\n   * @param {LayerSystem} layerSystem - The layer system to display\n   * @param {Object} options - UI configuration options\n   */\n  constructor(layerSystem, options = {}) {\n    this.layerSystem = layerSystem;\n    this.options = {\n      ...options,\n      position: options.position || 'top-right',\n      width: options.width || 280,\n      collapsible: options.collapsible !== false,\n      draggable: options.draggable !== false,\n      thumbnailPadding: options.thumbnailPadding ?? 4,\n      thumbnailSampleMaxSize: options.thumbnailSampleMaxSize ?? 196,\n      thumbnailAlphaThreshold: options.thumbnailAlphaThreshold ?? 12,\n      thumbnailAnimationWindow: options.thumbnailAnimationWindow ?? 6,\n      thumbnailEmptyFrameReset: options.thumbnailEmptyFrameReset ?? 6,\n      thumbnailSampleStride: options.thumbnailSampleStride ?? 1,\n      thumbnailAutoUpdate: options.thumbnailAutoUpdate === true,\n      thumbnailUpdateEvery: options.thumbnailUpdateEvery ?? 0\n    };\n\n    // Warn if thumbnailUpdateEvery is set but thumbnailAutoUpdate is false\n    if (options.thumbnailUpdateEvery !== undefined && options.thumbnailUpdateEvery > 0 && !this.options.thumbnailAutoUpdate) {\n      console.warn('p5.millefeuille: thumbnailUpdateEvery is set but thumbnailAutoUpdate is false. thumbnailUpdateEvery will be ignored. Set thumbnailAutoUpdate: true to enable automatic thumbnail updates.');\n    }\n\n    this.isCollapsed = false;\n    this.container = null;\n    this.layerElements = new Map(); // layerId -> DOM element\n    this.selectedLayerId = null; // Currently selected layer\n    this._dirtyThumbnailLayerIds = new Set();\n    this._captureNeeded = new Set();\n    this._thumbnailCache = new Map(); // layerId -> { image }\n    this._thumbnailFlushHandle = null;\n    this._cancelThumbnailFlush = null;\n    this._thumbnailBatchSize = 1;\n    this._thumbnailIdleBudgetMs = 8;\n    this._thumbnailScratchCanvas = typeof document !== 'undefined' ? document.createElement('canvas') : null;\n    this._thumbnailScratchCtx = this._thumbnailScratchCanvas ? this._thumbnailScratchCanvas.getContext('2d') : null;\n    if (this._thumbnailScratchCtx) {\n      this._thumbnailScratchCtx.imageSmoothingEnabled = false;\n    }\n    // Lazy-initialized WEBGL buffer for GPU-to-GPU downsampling\n    this._downsampleBuffer = null;\n\n    this._checkerPatternCanvas = typeof document !== 'undefined' ? document.createElement('canvas') : null;\n    this._checkerPatternCache = typeof WeakMap !== 'undefined' ? new WeakMap() : null;\n    if (this._checkerPatternCanvas) {\n      const size = 8;\n      this._checkerPatternCanvas.width = size;\n      this._checkerPatternCanvas.height = size;\n      const checkerCtx = this._checkerPatternCanvas.getContext('2d');\n      if (checkerCtx) {\n        checkerCtx.fillStyle = '#333';\n        checkerCtx.fillRect(0, 0, size, size);\n        checkerCtx.fillStyle = '#444';\n        checkerCtx.fillRect(0, 0, size / 2, size / 2);\n        checkerCtx.fillRect(size / 2, size / 2, size / 2, size / 2);\n      }\n    }\n\n    this._createUI();\n    this._attachStyles();\n  }\n\n  /**\n   * Creates the DOM structure for the UI panel\n   * @private\n   */\n  _createUI() {\n    // Create main container\n    this.container = document.createElement('div');\n    this.container.className = 'p5ml-layer-panel';\n    this.container.style.width = `${this.options.width}px`;\n\n    // Create header\n    const header = document.createElement('div');\n    header.className = 'p5ml-panel-header';\n    header.innerHTML = `\n      <span class=\"p5ml-panel-title\">Layers</span>\n      <div class=\"p5ml-header-controls\">\n        <button class=\"p5ml-arrow-btn p5ml-arrow-up\" title=\"Move layer up\">↑</button>\n        <button class=\"p5ml-arrow-btn p5ml-arrow-down\" title=\"Move layer down\">↓</button>\n        ${this.options.collapsible ? '<button class=\"p5ml-collapse-btn\">−</button>' : ''}\n      </div>\n    `;\n    this.container.appendChild(header);\n\n    // Create layers container\n    this.layersContainer = document.createElement('div');\n    this.layersContainer.className = 'p5ml-layers-container';\n    this.container.appendChild(this.layersContainer);\n\n    // Add to document\n    document.body.appendChild(this.container);\n\n    // Position the panel\n    this._positionPanel();\n\n    // Get cleanup signal for event listeners\n    const signal = this.layerSystem.p._removeSignal;\n\n    // Add event listeners\n    if (this.options.collapsible) {\n      const collapseBtn = header.querySelector('.p5ml-collapse-btn');\n      collapseBtn.addEventListener('click', () => this.toggle(), { signal });\n      // Prevent collapse button from triggering drag\n      collapseBtn.addEventListener('mousedown', (e) => e.stopPropagation(), { signal });\n    }\n\n    // Arrow button handlers\n    const upBtn = header.querySelector('.p5ml-arrow-up');\n    const downBtn = header.querySelector('.p5ml-arrow-down');\n    upBtn.addEventListener('click', () => this._moveSelectedLayer(-1), { signal });\n    downBtn.addEventListener('click', () => this._moveSelectedLayer(1), { signal });\n    // Prevent arrow buttons from triggering drag\n    upBtn.addEventListener('mousedown', (e) => e.stopPropagation(), { signal });\n    downBtn.addEventListener('mousedown', (e) => e.stopPropagation(), { signal });\n\n    // Make draggable if enabled\n    if (this.options.draggable) {\n      this._makeDraggable(header);\n    }\n\n    // Close dropdowns and deselect when clicking outside\n    document.addEventListener('click', (e) => {\n      // Check if click is outside the layer panel\n      if (!this.container.contains(e.target)) {\n        this._closeAllDropdowns();\n        this._deselectLayer();\n      }\n    }, { signal });\n\n    // Keyboard navigation for arrow keys\n    document.addEventListener('keydown', (e) => {\n      if (e.key !== 'ArrowUp' && e.key !== 'ArrowDown') {\n        return;\n      }\n\n      if (e.repeat || this.selectedLayerId === null) {\n        return;\n      }\n\n      if (!this._isPanelVisible()) {\n        return;\n      }\n\n      // Don't interfere if user is typing in an input field\n      if (e.target.matches('input, select, textarea')) {\n        return;\n      }\n\n      e.preventDefault();\n\n      this._moveSelectedLayer(e.key === 'ArrowUp' ? -1 : 1);\n    }, { signal });\n  }\n\n  /**\n   * Closes all open layer dropdowns\n   * @private\n   */\n  _closeAllDropdowns() {\n    document.querySelectorAll('.p5ml-layer-dropdown').forEach(d => {\n      d.style.display = 'none';\n    });\n  }\n\n  /**\n   * Positions the panel based on options\n   * @private\n   */\n  _positionPanel() {\n    const positions = {\n      'top-right': { top: '20px', right: '20px' },\n      'top-left': { top: '20px', left: '20px' },\n      'bottom-right': { bottom: '20px', right: '20px' },\n      'bottom-left': { bottom: '20px', left: '20px' }\n    };\n\n    const pos = positions[this.options.position] || positions['top-right'];\n    Object.assign(this.container.style, pos);\n  }\n\n  /**\n   * Determines if the panel is currently visible on screen\n   * @private\n   */\n  _isPanelVisible() {\n    if (!this.container || this.container.style.display === 'none') {\n      return false;\n    }\n    return this.container.getClientRects().length > 0;\n  }\n\n  /**\n   * Makes the panel draggable\n   * @private\n   */\n  _makeDraggable(header) {\n    let isDragging = false;\n    let offsetX;\n    let offsetY;\n\n    header.style.cursor = 'move';\n\n    const signal = this.layerSystem.p._removeSignal;\n\n    header.addEventListener('mousedown', (e) => {\n      // Get current position using getBoundingClientRect for accuracy\n      const rect = this.container.getBoundingClientRect();\n      \n      // Calculate offset from mouse to panel's top-left corner\n      offsetX = e.clientX - rect.left;\n      offsetY = e.clientY - rect.top;\n      \n      isDragging = true;\n\n      // Clear all positioning properties and switch to left/top only\n      this.container.style.right = '';\n      this.container.style.bottom = '';\n      this.container.style.left = rect.left + 'px';\n      this.container.style.top = rect.top + 'px';\n    });\n\n    document.addEventListener('mousemove', (e) => {\n      if (isDragging) {\n        e.preventDefault();\n        \n        // Calculate new position\n        let newX = e.clientX - offsetX;\n        let newY = e.clientY - offsetY;\n\n        // Get panel dimensions\n        const panelWidth = this.container.offsetWidth;\n        \n        // Get viewport dimensions\n        const viewportWidth = window.innerWidth;\n        const viewportHeight = window.innerHeight;\n        \n        // Constrain position to keep panel visible (with minimum 50px visible)\n        const minVisible = 50;\n        newX = Math.max(-panelWidth + minVisible, Math.min(newX, viewportWidth - minVisible));\n        newY = Math.max(0, Math.min(newY, viewportHeight - minVisible));\n\n        this.container.style.left = newX + 'px';\n        this.container.style.top = newY + 'px';\n      }\n    }, { signal });\n\n    document.addEventListener('mouseup', () => {\n      isDragging = false;\n    }, { signal });\n  }\n\n  /**\n   * Updates the UI to reflect current layer state\n   */\n  update() {\n    const layers = this.layerSystem.getLayers();\n\n    this._pruneThumbnailState(layers);\n\n    // Clear existing layer elements\n    this.layersContainer.innerHTML = '';\n    this.layerElements.clear();\n\n    // Create elements for each layer (reverse order so top layers appear first)\n    const reversedLayers = [...layers].reverse();\n\n    reversedLayers.forEach(layer => {\n      const layerEl = this._createLayerElement(layer);\n      this.layersContainer.appendChild(layerEl);\n      this.layerElements.set(layer.id, layerEl);\n    });\n\n    // Initial thumbnail render is scheduled lazily to avoid blocking\n    this._markThumbnailsDirty(reversedLayers.map(layer => layer.id), { needsCapture: true });\n  }\n\n  /**\n   * Public helper so the LayerSystem can schedule updates when layer content changes\n   * @param {number|string} layerId\n   * @param {{needsCapture?: boolean}} options\n   */\n  scheduleThumbnailUpdate(layerId, options = {}) {\n    this._markThumbnailsDirty([layerId], options);\n  }\n\n  /**\n   * Synchronizes UI controls with current layer state without recreating elements\n   */\n  syncState() {\n    const layers = this.layerSystem.getLayers();\n\n    layers.forEach(layer => {\n      const layerEl = this.layerElements.get(layer.id);\n      if (!layerEl) return;\n\n      // Update checkbox\n      const checkbox = layerEl.querySelector('.p5ml-visibility-checkbox');\n      if (checkbox) {\n        checkbox.checked = layer.visible;\n      }\n\n      // Update opacity slider and value\n      const opacitySlider = layerEl.querySelector('.p5ml-opacity-slider');\n      const opacityValue = layerEl.querySelector('.p5ml-opacity-value');\n      if (opacitySlider && opacityValue) {\n        const opacityPercent = Math.round(layer.opacity * 100);\n        opacitySlider.value = opacityPercent;\n        opacityValue.textContent = opacityPercent + '%';\n      }\n\n      // Update blend mode select and indicator\n      const blendSelect = layerEl.querySelector('.p5ml-blend-select');\n      const blendIndicator = layerEl.querySelector('.p5ml-blend-indicator');\n      if (blendSelect) {\n        blendSelect.value = layer.blendMode;\n      }\n      if (blendIndicator) {\n        blendIndicator.textContent = this._getBlendModeLetter(layer.blendMode);\n        blendIndicator.title = `Blend Mode: ${layer.blendMode}`;\n      }\n    });\n\n    // Thumbnails are only updated when clicked (not automatically)\n  }\n\n  /**\n   * Updates all thumbnails\n   * @private\n   */\n  _markThumbnailsDirty(layerIds = [], options = {}) {\n    const ids = Array.isArray(layerIds) ? layerIds : [layerIds];\n    const needsCapture = !!options.needsCapture;\n    let shouldSchedule = false;\n\n    // Determine if this frame should trigger an update based on settings\n    // If thumbnailAutoUpdate is false, no automatic updates (thumbnailUpdateEvery is ignored)\n    // If thumbnailAutoUpdate is true and thumbnailUpdateEvery is not set (0), update every frame\n    // If thumbnailAutoUpdate is true and thumbnailUpdateEvery > 0, update every N frames\n    let isUpdateFrame = false;\n    if (this.options.thumbnailAutoUpdate && needsCapture) {\n      const updateEvery = this.options.thumbnailUpdateEvery;\n      if (updateEvery <= 0) {\n        // Default to every frame when thumbnailAutoUpdate is true but thumbnailUpdateEvery not set\n        isUpdateFrame = true;\n      } else {\n        // Use p5's frameCount to determine update frames consistently across all layers\n        const frameCount = this.layerSystem.p.frameCount || 0;\n        isUpdateFrame = frameCount % updateEvery === 0;\n      }\n    }\n\n    ids.forEach(id => {\n      if (id === null || id === undefined) {\n        return;\n      }\n\n      const cacheEntry = this._thumbnailCache.get(id);\n      const hasThumbnail = !!(cacheEntry && cacheEntry.image);\n\n      // Without auto updates, skip automatic updates for existing thumbnails.\n      // Thumbnails will only update when user clicks the layer row.\n      if (!isUpdateFrame && hasThumbnail && needsCapture) {\n        return;\n      }\n\n      this._dirtyThumbnailLayerIds.add(id);\n      if (needsCapture) {\n        this._captureNeeded.add(id);\n      }\n\n      // Schedule flush if auto updates enabled, or if first capture needed\n      if (isUpdateFrame || (!hasThumbnail && needsCapture)) {\n        shouldSchedule = true;\n      }\n    });\n\n    if (!shouldSchedule) {\n      return;\n    }\n    this._scheduleThumbnailFlush();\n  }\n\n  /**\n   * Removes cached thumbnail data for layers that no longer exist\n   * @private\n   */\n  _pruneThumbnailState(activeLayers) {\n    const liveIds = new Set(activeLayers.map(layer => layer.id));\n\n    for (const id of Array.from(this._thumbnailCache.keys())) {\n      if (!liveIds.has(id)) {\n        this._thumbnailCache.delete(id);\n      }\n    }\n\n    for (const id of Array.from(this._captureNeeded)) {\n      if (!liveIds.has(id)) {\n        this._captureNeeded.delete(id);\n      }\n    }\n\n    for (const id of Array.from(this._dirtyThumbnailLayerIds)) {\n      if (!liveIds.has(id)) {\n        this._dirtyThumbnailLayerIds.delete(id);\n      }\n    }\n  }\n\n  /**\n   * Processes a small batch of dirty thumbnails on each animation frame\n   * @private\n   */\n  _flushDirtyThumbnails(deadline) {\n    if (this._dirtyThumbnailLayerIds.size === 0) {\n      return;\n    }\n\n    const hasPerformanceNow = typeof performance !== 'undefined' && typeof performance.now === 'function';\n    const start = hasPerformanceNow ? performance.now() : null;\n\n    const timeRemaining = (deadline && typeof deadline.timeRemaining === 'function')\n      ? () => deadline.timeRemaining()\n      : () => {\n        if (!hasPerformanceNow || start === null) {\n          return Number.POSITIVE_INFINITY;\n        }\n        const elapsed = performance.now() - start;\n        return Math.max(0, this._thumbnailIdleBudgetMs - elapsed);\n      };\n\n    const shouldYield = () => timeRemaining() <= 1;\n\n    let processed = 0;\n    while (this._dirtyThumbnailLayerIds.size > 0) {\n      if (processed >= this._thumbnailBatchSize) {\n        break;\n      }\n\n      const iterator = this._dirtyThumbnailLayerIds.values().next();\n      if (iterator.done) {\n        break;\n      }\n      const layerId = iterator.value;\n      this._dirtyThumbnailLayerIds.delete(layerId);\n      this._updateLayerThumbnail(layerId);\n      processed++;\n\n      if (shouldYield()) {\n        break;\n      }\n    }\n  }\n\n  /**\n   * Schedules a flush using requestIdleCallback/requestAnimationFrame fallback\n   * @private\n   */\n  _scheduleThumbnailFlush() {\n    if (this._thumbnailFlushHandle !== null || this._dirtyThumbnailLayerIds.size === 0) {\n      return;\n    }\n\n    const flushCallback = (deadline) => {\n      this._thumbnailFlushHandle = null;\n      this._cancelThumbnailFlush = null;\n      this._flushDirtyThumbnails(deadline);\n      if (this._dirtyThumbnailLayerIds.size > 0) {\n        this._scheduleThumbnailFlush();\n      }\n    };\n\n    if (typeof window !== 'undefined' && typeof window.requestIdleCallback === 'function') {\n      this._thumbnailFlushHandle = window.requestIdleCallback(flushCallback);\n      this._cancelThumbnailFlush = (handle) => window.cancelIdleCallback(handle);\n    } else if (typeof window !== 'undefined' && typeof window.requestAnimationFrame === 'function') {\n      this._thumbnailFlushHandle = window.requestAnimationFrame(() => flushCallback());\n      this._cancelThumbnailFlush = (handle) => window.cancelAnimationFrame(handle);\n    } else {\n      this._thumbnailFlushHandle = setTimeout(() => flushCallback(), 16);\n      this._cancelThumbnailFlush = (handle) => clearTimeout(handle);\n    }\n  }\n\n  /**\n   * Updates thumbnails for a specific layer\n   * @private\n   */\n  _updateLayerThumbnail(layerId) {\n    this._dirtyThumbnailLayerIds.delete(layerId);\n    const layer = this.layerSystem.getLayers().find(l => l.id === layerId);\n    if (!layer) return;\n\n    const layerEl = this.layerElements.get(layerId);\n    if (!layerEl) return;\n\n    const canvas = layerEl.querySelector('.p5ml-thumbnail-canvas');\n    if (!canvas) return;\n\n    const ctx = canvas.getContext('2d');\n    if (!ctx) {\n      return;\n    }\n\n    const cacheEntry = this._getOrCreateThumbnailCacheEntry(layerId);\n    let sourceCanvas = cacheEntry.image && cacheEntry.image.canvas ? cacheEntry.image.canvas : null;\n    const needsCapture = this._captureNeeded.has(layerId) || !sourceCanvas;\n\n    if (needsCapture) {\n      const captured = this._captureLayerImage(layer);\n      if (captured && captured.canvas) {\n        cacheEntry.image = captured;\n        sourceCanvas = captured.canvas;\n        cacheEntry.boundsDirty = true;\n        this._captureNeeded.delete(layerId);\n      }\n    }\n\n    if (!sourceCanvas) {\n      return;\n    }\n\n    const previousSize = cacheEntry.lastSourceSize;\n    if (!previousSize || previousSize.width !== sourceCanvas.width || previousSize.height !== sourceCanvas.height) {\n      cacheEntry.window = [];\n    }\n    cacheEntry.lastSourceSize = { width: sourceCanvas.width, height: sourceCanvas.height };\n\n    if (this._thumbnailScratchCtx && (cacheEntry.boundsDirty || !cacheEntry.drawBounds)) {\n      const rawBounds = this._calculateBoundsFromCanvas(sourceCanvas);\n      // If first capture is empty, don't cache it - allow future updates\n      if (!rawBounds && !cacheEntry.drawBounds) {\n        cacheEntry.image = null;\n        return;\n      }\n      this._applyBoundsToCache(cacheEntry, rawBounds, sourceCanvas);\n      cacheEntry.boundsDirty = false;\n    } else if (!cacheEntry.drawBounds) {\n      cacheEntry.drawBounds = this._createFullBounds(sourceCanvas);\n      cacheEntry.boundsDirty = false;\n    }\n\n    const drawBounds = cacheEntry.drawBounds || this._createFullBounds(sourceCanvas);\n\n    const cropAmount = this._getCropAmount(sourceCanvas, drawBounds);\n    this._drawCheckerboard(ctx, canvas.width, canvas.height, cropAmount);\n    this._drawThumbnailImage(ctx, canvas, sourceCanvas, drawBounds);\n  }\n\n  _getOrCreateThumbnailCacheEntry(layerId) {\n    if (!this._thumbnailCache.has(layerId)) {\n      this._thumbnailCache.set(layerId, {\n        image: null,\n        boundsDirty: false,\n        window: [],\n        emptyFrames: 0,\n        drawBounds: null,\n        lastSourceSize: null\n      });\n    }\n    return this._thumbnailCache.get(layerId);\n  }\n\n  /**\n   * Lazily initializes a framebuffer for GPU-to-GPU downsampling.\n   * Uses p5.Framebuffer to stay in the same WebGL context as source framebuffers.\n   * @private\n   */\n  _getDownsampleBuffer(width, height) {\n    const p = this.layerSystem.p;\n    if (!p || typeof p.createFramebuffer !== 'function') {\n      return null;\n    }\n\n    // Create or resize the buffer as needed\n    if (!this._downsampleBuffer) {\n      try {\n        this._downsampleBuffer = p.createFramebuffer({\n          width,\n          height,\n          density: 1,\n          depthFormat: p.UNSIGNED_INT,\n          textureFiltering: p.LINEAR\n        });\n      } catch (e) {\n        console.debug('Could not create downsample framebuffer:', e);\n        return null;\n      }\n    } else if (this._downsampleBuffer.width !== width || this._downsampleBuffer.height !== height) {\n      this._downsampleBuffer.resize(width, height);\n    }\n\n    return this._downsampleBuffer;\n  }\n\n  /**\n   * Captures a downsampled image from a framebuffer using GPU-to-GPU copy.\n   * This avoids reading the full framebuffer, reducing readback from ~8MB to ~150KB.\n   * @private\n   */\n  _captureLayerImage(layer) {\n    const source = layer.framebuffer;\n    if (!source) {\n      return null;\n    }\n\n    const p = this.layerSystem.p;\n    if (!p) {\n      return null;\n    }\n\n    // Calculate downsampled dimensions\n    const maxSize = Math.max(1, this.options.thumbnailSampleMaxSize);\n    const sourceWidth = source.width || p.width;\n    const sourceHeight = source.height || p.height;\n    const largestSide = Math.max(sourceWidth, sourceHeight);\n    const scale = largestSide > maxSize ? maxSize / largestSide : 1;\n    const sampleWidth = Math.max(1, Math.round(sourceWidth * scale));\n    const sampleHeight = Math.max(1, Math.round(sourceHeight * scale));\n\n    try {\n      const buffer = this._getDownsampleBuffer(sampleWidth, sampleHeight);\n      if (!buffer) {\n        // Fallback to direct get() if buffer creation failed\n        if (typeof source.get === 'function') {\n          return source.get();\n        }\n        return null;\n      }\n\n      // GPU-to-GPU copy: render source framebuffer to small buffer\n      buffer.begin();\n      p.clear();\n      p.push();\n      p.imageMode(p.CORNER);\n      // Translate to top-left corner (WEBGL origin is center)\n      p.translate(-sampleWidth / 2, -sampleHeight / 2);\n      p.image(source, 0, 0, sampleWidth, sampleHeight);\n      p.pop();\n      buffer.end();\n\n      // Small readback: only ~150KB instead of ~8MB\n      const result = buffer.get();\n\n      // Store original dimensions for bounds scaling\n      result._originalWidth = sourceWidth;\n      result._originalHeight = sourceHeight;\n\n      return result;\n    } catch (e) {\n      console.debug('Could not capture downsampled thumbnail:', e);\n      // Fallback to direct get()\n      if (typeof source.get === 'function') {\n        return source.get();\n      }\n      return null;\n    }\n  }\n\n  _calculateBoundsFromCanvas(sourceCanvas) {\n    if (!this._thumbnailScratchCtx || !sourceCanvas.width || !sourceCanvas.height) {\n      return null;\n    }\n\n    const maxSize = Math.max(1, this.options.thumbnailSampleMaxSize);\n    const largestSide = Math.max(sourceCanvas.width, sourceCanvas.height);\n    const scale = largestSide > maxSize ? maxSize / largestSide : 1;\n    const sampleWidth = Math.max(1, Math.round(sourceCanvas.width * scale));\n    const sampleHeight = Math.max(1, Math.round(sourceCanvas.height * scale));\n\n    this._thumbnailScratchCanvas.width = sampleWidth;\n    this._thumbnailScratchCanvas.height = sampleHeight;\n\n    const ctx = this._thumbnailScratchCtx;\n    ctx.clearRect(0, 0, sampleWidth, sampleHeight);\n    ctx.drawImage(sourceCanvas, 0, 0, sampleWidth, sampleHeight);\n\n    let imageData;\n    try {\n      imageData = ctx.getImageData(0, 0, sampleWidth, sampleHeight);\n    } catch (e) {\n      console.debug('Could not read thumbnail buffer:', e);\n      return null;\n    }\n\n    const bounds = computeAlphaBounds(imageData.data, sampleWidth, sampleHeight, {\n      alphaThreshold: this.options.thumbnailAlphaThreshold,\n      stride: this.options.thumbnailSampleStride\n    });\n\n    if (!bounds) {\n      return null;\n    }\n\n    const scaleX = sourceCanvas.width / sampleWidth;\n    const scaleY = sourceCanvas.height / sampleHeight;\n    return {\n      x: bounds.x * scaleX,\n      y: bounds.y * scaleY,\n      width: bounds.width * scaleX,\n      height: bounds.height * scaleY\n    };\n  }\n\n  _applyBoundsToCache(cacheEntry, bounds, sourceSize) {\n    if (!cacheEntry) {\n      return;\n    }\n\n    // Only use sliding window smoothing when thumbnailAutoUpdate is true (every frame).\n    // With irregular updates (thumbnailUpdateEvery or click-only), use bounds directly.\n    const useSmoothing = this.options.thumbnailAutoUpdate;\n\n    if (!useSmoothing) {\n      // Direct mode: just use the current bounds with padding\n      if (bounds && bounds.width > 0 && bounds.height > 0) {\n        cacheEntry.drawBounds = padBounds(\n          bounds,\n          this.options.thumbnailPadding,\n          sourceSize.width,\n          sourceSize.height\n        );\n      } else if (!cacheEntry.drawBounds) {\n        cacheEntry.drawBounds = this._createFullBounds(sourceSize);\n      }\n      return;\n    }\n\n    // Smoothing mode: use sliding window for every-frame updates\n    if (!cacheEntry.window) {\n      cacheEntry.window = [];\n    }\n\n    if (bounds) {\n      cacheEntry.window.push(bounds);\n      const maxWindow = Math.max(1, this.options.thumbnailAnimationWindow || 0);\n      while (cacheEntry.window.length > maxWindow) {\n        cacheEntry.window.shift();\n      }\n      cacheEntry.emptyFrames = 0;\n    } else {\n      const resetLimit = Math.max(1, this.options.thumbnailEmptyFrameReset || 0);\n      cacheEntry.emptyFrames = (cacheEntry.emptyFrames || 0) + 1;\n      if (cacheEntry.emptyFrames >= resetLimit) {\n        cacheEntry.window = [];\n        cacheEntry.emptyFrames = resetLimit;\n      }\n    }\n\n    const merged = mergeBounds(cacheEntry.window);\n    const padded = merged\n      ? padBounds(merged, this.options.thumbnailPadding, sourceSize.width, sourceSize.height)\n      : null;\n\n    if (padded && padded.width > 0 && padded.height > 0) {\n      cacheEntry.drawBounds = padded;\n    } else if (!cacheEntry.drawBounds) {\n      cacheEntry.drawBounds = this._createFullBounds(sourceSize);\n    }\n\n    if (!cacheEntry.window.length) {\n      cacheEntry.drawBounds = this._createFullBounds(sourceSize);\n    }\n  }\n\n  _createFullBounds(sourceSize) {\n    const width = sourceSize.width || 0;\n    const height = sourceSize.height || 0;\n    return { x: 0, y: 0, width, height };\n  }\n\n  /**\n   * Returns a scalar in [0, 1] representing how tight the crop is.\n   * 0 = no crop (full layer), 1 = extremely tight crop (tiny region)\n   * @private\n   */\n  _getCropAmount(sourceCanvas, bounds) {\n    if (!sourceCanvas || !bounds || bounds.width <= 0 || bounds.height <= 0) {\n      return 0;\n    }\n\n    const layerWidth = sourceCanvas.width || 1;\n    const layerHeight = sourceCanvas.height || 1;\n    const areaLayer = layerWidth * layerHeight;\n    const areaCrop = bounds.width * bounds.height;\n\n    if (!Number.isFinite(areaLayer) || areaLayer <= 0) {\n      return 0;\n    }\n\n    const visibleFraction = Math.max(0, Math.min(1, areaCrop / areaLayer));\n    return 1 - visibleFraction;\n  }\n\n  _drawThumbnailImage(ctx, targetCanvas, sourceCanvas, bounds) {\n    if (!bounds || bounds.width <= 0 || bounds.height <= 0) {\n      return;\n    }\n\n    // Always fit the cropped region into the thumbnail while preserving aspect\n    const scale = Math.min(\n      targetCanvas.width / bounds.width,\n      targetCanvas.height / bounds.height\n    );\n\n    const destWidth = Math.max(1, bounds.width * scale);\n    const destHeight = Math.max(1, bounds.height * scale);\n    const destX = (targetCanvas.width - destWidth) / 2;\n    const destY = (targetCanvas.height - destHeight) / 2;\n\n    ctx.save();\n    ctx.imageSmoothingEnabled = false;\n    ctx.drawImage(\n      sourceCanvas,\n      bounds.x,\n      bounds.y,\n      bounds.width,\n      bounds.height,\n      destX,\n      destY,\n      destWidth,\n      destHeight\n    );\n    ctx.restore();\n  }\n\n  /**\n   * Creates a DOM element for a single layer\n   * @private\n   */\n  _createLayerElement(layer) {\n    const layerEl = document.createElement('div');\n    layerEl.className = 'p5ml-layer-item';\n    layerEl.dataset.layerId = layer.id;\n\n    // Add click handler to select layer and update thumbnail\n    const signal = this.layerSystem.p._removeSignal;\n    layerEl.addEventListener('click', (e) => {\n      // Close all dropdowns when clicking on the layer row itself\n      if (e.target.classList.contains('p5ml-layer-row') ||\n          e.target.classList.contains('p5ml-layer-name') ||\n          e.target.classList.contains('p5ml-layer-thumbnail') ||\n          e.target.classList.contains('p5ml-thumbnail-canvas')) {\n        this._closeAllDropdowns();\n        this._selectLayer(layer.id);\n        // Force capture on click so thumbnail updates with current layer content\n        this._captureNeeded.add(layer.id);\n        this._updateLayerThumbnail(layer.id);\n      }\n    }, { signal });\n\n    // Main layer row (Procreate style: thumbnail | name | blend letter | checkbox)\n    const layerRow = document.createElement('div');\n    layerRow.className = 'p5ml-layer-row';\n\n    // Left: Thumbnail\n    const thumbnail = this._createThumbnail();\n    thumbnail.className = 'p5ml-layer-thumbnail';\n    layerRow.appendChild(thumbnail);\n\n    // Center: Layer name\n    const nameSpan = document.createElement('span');\n    nameSpan.className = 'p5ml-layer-name';\n    nameSpan.textContent = layer.name;\n    layerRow.appendChild(nameSpan);\n\n    // Right side controls container\n    const rightControls = document.createElement('div');\n    rightControls.className = 'p5ml-right-controls';\n\n    // Blend mode letter indicator (clickable)\n    const blendIndicator = document.createElement('button');\n    blendIndicator.className = 'p5ml-blend-indicator';\n    blendIndicator.textContent = this._getBlendModeLetter(layer.blendMode);\n    blendIndicator.title = `Blend Mode: ${layer.blendMode}`;\n    blendIndicator.addEventListener('click', (e) => {\n      e.stopPropagation();\n      const dropdown = layerEl.querySelector('.p5ml-layer-dropdown');\n      const isExpanded = dropdown.style.display === 'block';\n\n      // Close all other dropdowns first\n      this._closeAllDropdowns();\n\n      // Toggle this dropdown (if it wasn't already open)\n      dropdown.style.display = isExpanded ? 'none' : 'block';\n    }, { signal });\n\n    // Visibility checkbox\n    const visibilityCheckbox = document.createElement('input');\n    visibilityCheckbox.type = 'checkbox';\n    visibilityCheckbox.className = 'p5ml-visibility-checkbox';\n    visibilityCheckbox.checked = layer.visible;\n    visibilityCheckbox.title = 'Toggle visibility';\n    visibilityCheckbox.addEventListener('change', (e) => {\n      e.stopPropagation();\n      if (e.target.checked) {\n        this.layerSystem.show(layer.id);\n      } else {\n        this.layerSystem.hide(layer.id);\n      }\n    }, { signal });\n\n    rightControls.appendChild(blendIndicator);\n    rightControls.appendChild(visibilityCheckbox);\n    layerRow.appendChild(rightControls);\n\n    // Dropdown panel (hidden by default, shown when blend indicator is clicked)\n    const dropdown = document.createElement('div');\n    dropdown.className = 'p5ml-layer-dropdown';\n    dropdown.style.display = 'none';\n\n    // Opacity control\n    const opacityGroup = document.createElement('div');\n    opacityGroup.className = 'p5ml-control-group';\n\n    const opacityLabel = document.createElement('label');\n    opacityLabel.textContent = 'OPACITY';\n\n    const opacityValue = document.createElement('span');\n    opacityValue.className = 'p5ml-opacity-value';\n    opacityValue.textContent = Math.round(layer.opacity * 100) + '%';\n\n    const opacitySlider = document.createElement('input');\n    opacitySlider.type = 'range';\n    opacitySlider.min = '0';\n    opacitySlider.max = '100';\n    opacitySlider.value = Math.round(layer.opacity * 100);\n    opacitySlider.className = 'p5ml-opacity-slider';\n    opacitySlider.addEventListener('input', (e) => {\n      e.stopPropagation();\n      const value = parseFloat(e.target.value) / 100;\n      this.layerSystem.setOpacity(layer.id, value);\n      opacityValue.textContent = e.target.value + '%';\n    }, { signal });\n\n    opacityGroup.appendChild(opacityLabel);\n    opacityGroup.appendChild(opacityValue);\n    opacityGroup.appendChild(opacitySlider);\n\n    // Blend mode control\n    const blendGroup = document.createElement('div');\n    blendGroup.className = 'p5ml-control-group';\n\n    const blendLabel = document.createElement('label');\n    blendLabel.textContent = 'BLEND MODE';\n\n    const blendSelect = document.createElement('select');\n    blendSelect.className = 'p5ml-blend-select';\n\n    Object.values(BlendModes).forEach(mode => {\n      const option = document.createElement('option');\n      option.value = mode;\n      option.textContent = this._formatBlendModeName(mode);\n      option.selected = layer.blendMode === mode;\n      blendSelect.appendChild(option);\n    });\n\n    blendSelect.addEventListener('change', (e) => {\n      e.stopPropagation();\n      this.layerSystem.setBlendMode(layer.id, e.target.value);\n      blendIndicator.textContent = this._getBlendModeLetter(e.target.value);\n      blendIndicator.title = `Blend Mode: ${e.target.value}`;\n    }, { signal });\n\n    blendGroup.appendChild(blendLabel);\n    blendGroup.appendChild(blendSelect);\n\n    dropdown.appendChild(opacityGroup);\n    dropdown.appendChild(blendGroup);\n\n    // Assemble layer element\n    layerEl.appendChild(layerRow);\n    layerEl.appendChild(dropdown);\n\n    return layerEl;\n  }\n\n  /**\n   * Gets a single letter representing the blend mode\n   * @private\n   */\n  _getBlendModeLetter(blendMode) {\n    const letters = {\n      [BlendModes.NORMAL]: 'N',\n      [BlendModes.MULTIPLY]: 'M',\n      [BlendModes.SCREEN]: 'S',\n      [BlendModes.OVERLAY]: 'O',\n      [BlendModes.DARKEN]: 'D',\n      [BlendModes.LIGHTEN]: 'Li',\n      [BlendModes.COLOR_DODGE]: 'Cd',\n      [BlendModes.COLOR_BURN]: 'B',\n      [BlendModes.HARD_LIGHT]: 'HL',\n      [BlendModes.SOFT_LIGHT]: 'SL',\n      [BlendModes.DIFFERENCE]: 'Di',\n      [BlendModes.EXCLUSION]: 'E',\n      [BlendModes.ADD]: 'A',\n      [BlendModes.SUBTRACT]: 'Su',\n    };\n    return letters[blendMode] || '-';\n  }\n\n  /**\n   * Formats blend mode name for display\n   * @private\n   */\n  _formatBlendModeName(mode) {\n    // Convert BLEND_MODE to \"Blend Mode\"\n    return mode.split('_')\n      .map(word => word.charAt(0) + word.slice(1).toLowerCase())\n      .join(' ');\n  }\n\n  /**\n   * Creates a thumbnail canvas for a framebuffer or image\n   * @private\n   */\n  _createThumbnail() {\n    const container = document.createElement('div');\n    container.className = 'p5ml-thumbnail';\n\n    const canvas = document.createElement('canvas');\n    canvas.className = 'p5ml-thumbnail-canvas';\n    canvas.width = 60;\n    canvas.height = 60;\n\n    const ctx = canvas.getContext('2d');\n\n    // Draw a checkerboard background for transparency\n    this._drawCheckerboard(ctx, canvas.width, canvas.height);\n\n    container.appendChild(canvas);\n    return container;\n  }\n\n\n  /**\n   * Draws a checkerboard pattern for transparency background\n   * @private\n   */\n  _drawCheckerboard(ctx, width, height, cropAmount = 0) {\n    if (!ctx) {\n      return;\n    }\n\n    const pattern = this._getCheckerPattern(ctx);\n    const scale = this._getCheckerboardScale(cropAmount);\n\n    if (pattern && typeof ctx.save === 'function') {\n      ctx.save();\n      ctx.fillStyle = pattern;\n      const cx = width / 2;\n      const cy = height / 2;\n      ctx.translate(cx, cy);\n      ctx.scale(scale, scale);\n      ctx.translate(-cx, -cy);\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n      return;\n    }\n\n    // Fallback: discrete checkerboard (used in tests/mocks without pattern support)\n    const baseSize = 8;\n    const squareSize = Math.max(2, Math.round(baseSize * scale));\n    ctx.fillStyle = '#333';\n    ctx.fillRect(0, 0, width, height);\n    ctx.fillStyle = '#444';\n\n    for (let y = 0; y < height; y += squareSize) {\n      for (let x = 0; x < width; x += squareSize) {\n        if ((x / squareSize + y / squareSize) % 2 === 0) {\n          ctx.fillRect(x, y, squareSize, squareSize);\n        }\n      }\n    }\n  }\n\n  _getCheckerboardScale(cropAmount = 0) {\n    const t = Math.max(0, Math.min(1, Number.isFinite(cropAmount) ? cropAmount : 0));\n    return 1 + t * 1.2; // Scale from 1.0 to 2.2 based on crop\n  }\n\n  _getCheckerPattern(ctx) {\n    if (!ctx || !this._checkerPatternCanvas || typeof ctx.createPattern !== 'function') {\n      return null;\n    }\n\n    if (this._checkerPatternCache && this._checkerPatternCache.has(ctx)) {\n      return this._checkerPatternCache.get(ctx);\n    }\n\n    const pattern = ctx.createPattern(this._checkerPatternCanvas, 'repeat');\n    if (pattern && this._checkerPatternCache) {\n      this._checkerPatternCache.set(ctx, pattern);\n    }\n    return pattern;\n  }\n\n  /**\n   * Selects a layer\n   * @private\n   */\n  _selectLayer(layerId) {\n    this.selectedLayerId = layerId;\n\n    // Update visual selection state\n    const elements = document.querySelectorAll('.p5ml-layer-item');\n\n    elements.forEach(el => {\n      // Convert both to strings for comparison (dataset values are always strings)\n      if (el.dataset.layerId == layerId) {\n        el.classList.add('p5ml-selected');\n        // Force bright blue background with inline style\n        el.style.background = '#3a7bc8';\n        el.style.borderLeft = '3px solid #5dade2';\n      } else {\n        el.classList.remove('p5ml-selected');\n        // Remove inline styles\n        el.style.background = '';\n        el.style.borderLeft = '';\n      }\n    });\n  }\n\n  /**\n   * Deselects the currently selected layer\n   * @private\n   */\n  _deselectLayer() {\n    this.selectedLayerId = null;\n\n    // Remove visual selection state from all layers\n    document.querySelectorAll('.p5ml-layer-item').forEach(el => {\n      el.classList.remove('p5ml-selected');\n      // Remove inline styles\n      el.style.background = '';\n      el.style.borderLeft = '';\n    });\n  }\n\n  /**\n   * Moves the selected layer up or down in the stack\n   * @private\n   * @param {number} direction - -1 for up (higher in stack), 1 for down (lower in stack)\n   */\n  _moveSelectedLayer(direction) {\n    if (this.selectedLayerId === null) return;\n\n    const layers = this.layerSystem.getLayers();\n    const currentIndex = layers.findIndex(l => l.id === this.selectedLayerId);\n\n    if (currentIndex === -1) return;\n\n    // Calculate new index (remember layers are in bottom-to-top order)\n    // direction -1 means \"up\" which is higher index\n    // direction 1 means \"down\" which is lower index\n    const newIndex = currentIndex - direction;\n\n    // Check bounds\n    if (newIndex < 0 || newIndex >= layers.length) return;\n\n    // Swap layers\n    const targetLayer = layers[newIndex];\n\n    // Swap entries inside the layer array\n    [layers[currentIndex], layers[newIndex]] = [layers[newIndex], layers[currentIndex]];\n\n    // Move only the affected DOM nodes instead of rebuilding the entire list\n    const selectedElement = this.layerElements.get(this.selectedLayerId);\n    const targetElement = this.layerElements.get(targetLayer.id);\n    if (selectedElement && targetElement && this.layersContainer) {\n      if (direction === -1) {\n        this.layersContainer.insertBefore(selectedElement, targetElement);\n      } else {\n        const nextNode = targetElement.nextSibling;\n        this.layersContainer.insertBefore(selectedElement, nextNode);\n      }\n    }\n\n    // Only the swapped layers need their thumbnails refreshed\n    this._markThumbnailsDirty([this.selectedLayerId, targetLayer.id]);\n\n    // Update the layer system's internal order\n    if (typeof this.layerSystem.reorderLayers === 'function') {\n      this.layerSystem.reorderLayers(layers);\n    }\n\n    // Re-select the layer to keep the highlight consistent\n    this._selectLayer(this.selectedLayerId);\n  }\n\n  /**\n   * Attaches CSS styles to the document\n   * @private\n   */\n  _attachStyles() {\n    // Check if styles already exist\n    if (document.getElementById('p5ml-layer-ui-styles')) {\n      return;\n    }\n\n    const style = document.createElement('style');\n    style.id = 'p5ml-layer-ui-styles';\n    style.textContent = `\n      .p5ml-layer-panel {\n        position: fixed;\n        background: rgba(26, 26, 26, 0.95);\n        border: 1px solid #444;\n        border-radius: 8px;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n        font-size: 13px;\n        color: #e0e0e0;\n        z-index: 10000;\n        backdrop-filter: blur(10px);\n        overflow: hidden;\n      }\n\n      .p5ml-layer-panel.collapsed .p5ml-layers-container {\n        display: none;\n      }\n\n      .p5ml-panel-header {\n        background: rgba(60, 60, 60, 0.9);\n        padding: 12px 16px;\n        border-bottom: 1px solid #333;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        user-select: none;\n      }\n\n      .p5ml-panel-title {\n        font-weight: 600;\n        font-size: 16px;\n        letter-spacing: 0.5px;\n        color: #ccc;\n      }\n\n      .p5ml-header-controls {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n      }\n\n      .p5ml-arrow-btn {\n        background: rgba(255, 255, 255, 0.1);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 4px;\n        color: #e8e8e8;\n        font-size: 16px;\n        cursor: pointer;\n        padding: 4px 8px;\n        width: 28px;\n        height: 28px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.15s;\n      }\n\n      .p5ml-arrow-btn:hover {\n        background: rgba(255, 255, 255, 0.15);\n        border-color: rgba(255, 255, 255, 0.3);\n      }\n\n      .p5ml-arrow-btn:active {\n        background: rgba(255, 255, 255, 0.2);\n      }\n\n      .p5ml-collapse-btn {\n        background: none;\n        border: none;\n        color: #aaa;\n        font-size: 18px;\n        cursor: pointer;\n        padding: 0;\n        width: 20px;\n        height: 20px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n\n      .p5ml-collapse-btn:hover {\n        color: #fff;\n      }\n\n      .p5ml-layers-container {\n        max-height: 500px;\n        overflow-y: auto;\n        padding: 0;\n        background: #2a2a2a;\n      }\n\n      .p5ml-layers-container::-webkit-scrollbar {\n        width: 8px;\n      }\n\n      .p5ml-layers-container::-webkit-scrollbar-track {\n        background: rgba(0, 0, 0, 0.2);\n      }\n\n      .p5ml-layers-container::-webkit-scrollbar-thumb {\n        background: rgba(255, 255, 255, 0.2);\n        border-radius: 4px;\n      }\n\n      .p5ml-layers-container::-webkit-scrollbar-thumb:hover {\n        background: rgba(255, 255, 255, 0.3);\n      }\n\n      /* Procreate-style layer item */\n      .p5ml-layer-item {\n        background: transparent;\n        border-bottom: 1px solid #3a3a3a;\n        transition: background 0.15s ease;\n        cursor: pointer;\n      }\n\n      .p5ml-layer-item:hover {\n        background: rgba(100, 150, 255, 0.15);\n      }\n\n      /* Selected state */\n      .p5ml-layer-item.p5ml-selected {\n        background: #3a7bc8 !important;\n        border-left: 3px solid #5dade2;\n      }\n\n      .p5ml-layer-item.p5ml-selected:hover {\n        background: #4a8dd8 !important;\n      }\n\n      .p5ml-layer-item.p5ml-selected .p5ml-layer-row {\n        background: transparent;\n      }\n\n      /* Main layer row (horizontal layout) */\n      .p5ml-layer-row {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 10px 12px;\n      }\n\n      /* Thumbnail on the left */\n      .p5ml-layer-thumbnail {\n        flex-shrink: 0;\n      }\n\n      .p5ml-layer-thumbnail canvas {\n        display: block;\n        width: 60px;\n        height: 60px;\n        border: 1px solid #555;\n        border-radius: 4px;\n        image-rendering: pixelated;\n      }\n\n      /* Layer name in center */\n      .p5ml-layer-name {\n        flex: 1;\n        font-weight: 500;\n        font-size: 15px;\n        color: #e8e8e8;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n\n      /* Right side controls */\n      .p5ml-right-controls {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        flex-shrink: 0;\n      }\n\n      /* Blend mode letter indicator */\n      .p5ml-blend-indicator {\n        width: 28px;\n        height: 28px;\n        border-radius: 4px;\n        background: rgba(255, 255, 255, 0.1);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        color: #e8e8e8;\n        font-weight: 600;\n        font-size: 14px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        cursor: pointer;\n        transition: all 0.15s;\n        pointer-events: auto;\n      }\n\n      .p5ml-blend-indicator:hover {\n        background: rgba(255, 255, 255, 0.15);\n        border-color: rgba(255, 255, 255, 0.3);\n      }\n\n      /* Visibility checkbox */\n      .p5ml-visibility-checkbox {\n        width: 20px;\n        height: 20px;\n        cursor: pointer;\n        accent-color: #4a90e2;\n        pointer-events: auto;\n      }\n\n      /* Dropdown panel for opacity and blend mode */\n      .p5ml-layer-dropdown {\n        background: rgba(40, 40, 40, 0.95);\n        border-top: 1px solid #555;\n        padding: 16px;\n        display: none;\n      }\n\n      .p5ml-control-group {\n        margin-bottom: 16px;\n      }\n\n      .p5ml-control-group:last-child {\n        margin-bottom: 0;\n      }\n\n      .p5ml-control-group label {\n        font-size: 11px;\n        color: #999;\n        text-transform: uppercase;\n        letter-spacing: 0.8px;\n        font-weight: 600;\n        display: flex;\n        justify-content: space-between;\n        margin-bottom: 8px;\n      }\n\n      .p5ml-opacity-value {\n        color: #e0e0e0;\n        font-weight: 600;\n      }\n\n      .p5ml-opacity-slider {\n        width: 100%;\n        height: 6px;\n        border-radius: 3px;\n        outline: none;\n        -webkit-appearance: none;\n        background: rgba(255, 255, 255, 0.15);\n        margin-top: 4px;\n      }\n\n      .p5ml-opacity-slider::-webkit-slider-thumb {\n        -webkit-appearance: none;\n        appearance: none;\n        width: 18px;\n        height: 18px;\n        border-radius: 50%;\n        background: #fff;\n        cursor: pointer;\n        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);\n      }\n\n      .p5ml-opacity-slider::-moz-range-thumb {\n        width: 18px;\n        height: 18px;\n        border-radius: 50%;\n        background: #fff;\n        cursor: pointer;\n        border: none;\n        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);\n      }\n\n      .p5ml-blend-select {\n        width: 100%;\n        background: rgba(0, 0, 0, 0.4);\n        border: 1px solid #555;\n        border-radius: 6px;\n        color: #e8e8e8;\n        padding: 10px 12px;\n        font-size: 14px;\n        cursor: pointer;\n        outline: none;\n        margin-top: 4px;\n      }\n\n      .p5ml-blend-select:hover {\n        border-color: #777;\n        background: rgba(0, 0, 0, 0.5);\n      }\n\n      .p5ml-blend-select option {\n        background: #2a2a2a;\n        color: #e8e8e8;\n        padding: 8px;\n      }\n\n      /* Hide old thumbnail styles - no longer used */\n      .p5ml-thumbnail-label {\n        display: none;\n      }\n    `;\n\n    document.head.appendChild(style);\n  }\n\n  /**\n   * Toggles the collapsed state of the panel\n   */\n  toggle() {\n    this.isCollapsed = !this.isCollapsed;\n    this.container.classList.toggle('collapsed', this.isCollapsed);\n\n    const btn = this.container.querySelector('.p5ml-collapse-btn');\n    if (btn) {\n      btn.innerHTML = this.isCollapsed ? '+' : '−';\n    }\n  }\n\n  /**\n   * Shows the panel\n   */\n  show() {\n    this.container.style.display = 'block';\n  }\n\n  /**\n   * Hides the panel\n   */\n  hide() {\n    this.container.style.display = 'none';\n  }\n\n  /**\n   * Removes the panel from the DOM\n   */\n  dispose() {\n    if (this.container && this.container.parentNode) {\n      this.container.parentNode.removeChild(this.container);\n    }\n\n    if (this._cancelThumbnailFlush && this._thumbnailFlushHandle !== null) {\n      this._cancelThumbnailFlush(this._thumbnailFlushHandle);\n    }\n    this._dirtyThumbnailLayerIds.clear();\n    this._captureNeeded.clear();\n    this._thumbnailCache.clear();\n    this._thumbnailFlushHandle = null;\n    this._cancelThumbnailFlush = null;\n    this._thumbnailScratchCanvas = null;\n    this._thumbnailScratchCtx = null;\n  }\n}\n","import { Layer } from './Layer.js';\nimport { Compositor } from './Compositor.js';\nimport { BlendModes } from './constants.js';\nimport { LayerUI } from './LayerUI.js';\n\n/**\n * Main layer system manager\n */\nexport class LayerSystem {\n  /**\n   * @param {p5} p5Instance - The p5.js instance\n   */\n  constructor(p5Instance) {\n    this.p = p5Instance;\n\n    // Validate WebGL mode\n    if (!this.p._renderer || !this.p._renderer.drawingContext) {\n      throw new Error('Canvas not initialized. Make sure createCanvas() is called before createLayerSystem()');\n    }\n\n    if (this.p._renderer.drawingContext instanceof WebGLRenderingContext ||\n        this.p._renderer.drawingContext instanceof WebGL2RenderingContext) {\n      // WebGL mode confirmed\n    } else {\n      throw new Error('LayerSystem requires WebGL mode. Use createCanvas(w, h, WEBGL)');\n    }\n\n    this.layers = new Map(); // id -> Layer\n    this.layerNames = new Map(); // name -> id (for string-based lookups)\n    this.layerIdCounter = 0;\n    this.activeLayerId = null;\n    this.compositor = new Compositor(p5Instance);\n    this.ui = null; // LayerUI instance\n\n    // Track if we're auto-resizing\n    this.autoResize = true;\n    this._lastCanvasWidth = this.p.width;\n    this._lastCanvasHeight = this.p.height;\n    this._lastPixelDensity = this.p.pixelDensity();\n  }\n\n  /**\n   * Generates a unique layer ID\n   * @private\n   */\n  _generateId() {\n    return this.layerIdCounter++;\n  }\n\n  /**\n   * Gets a layer by ID or name\n   * @private\n   * @param {number|string} layerIdOrName - The layer ID (number) or name (string)\n   * @returns {Layer|null} The layer, or null if not found\n   */\n  _getLayerById(layerIdOrName) {\n    // If it's a number, look up directly by ID\n    if (typeof layerIdOrName === 'number') {\n      return this.layers.get(layerIdOrName) || null;\n    }\n    \n    // If it's a string, look up by name first\n    if (typeof layerIdOrName === 'string') {\n      const id = this.layerNames.get(layerIdOrName);\n      if (id !== undefined) {\n        return this.layers.get(id) || null;\n      }\n    }\n    \n    return null;\n  }\n\n  /**\n   * Creates a new layer\n   * @param {string} name - Optional name for the layer\n   * @param {Object} options - Layer configuration options\n   * @returns {Layer} The created layer instance\n   */\n  createLayer(name = '', options = {}) {\n    const id = this._generateId();\n    const layerName = name || `Layer ${id}`;\n    const layer = new Layer(this.p, id, layerName, {\n      ...options,\n      zIndex: options.zIndex !== undefined ? options.zIndex : id\n    });\n\n    this.layers.set(id, layer);\n    \n    // Register the name for string-based lookups\n    if (layerName) {\n      this.layerNames.set(layerName, id);\n    }\n    \n    return layer;\n  }\n\n  /**\n   * Removes a layer and disposes of its resources\n   * @param {number|string} layerIdOrName - The ID or name of the layer to remove\n   */\n  removeLayer(layerIdOrName) {\n    const layer = this._getLayerById(layerIdOrName);\n    if (!layer) {\n      console.warn(`Layer ${layerIdOrName} not found`);\n      return;\n    }\n\n    // If this layer is currently active, end it\n    if (this.activeLayerId === layer.id) {\n      this.end();\n    }\n\n    // Remove from name map if it has a name\n    if (layer.name) {\n      this.layerNames.delete(layer.name);\n    }\n\n    layer.dispose();\n    this.layers.delete(layer.id);\n  }\n\n  /**\n   * Gets a layer by ID or name\n   * @param {number|string} layerIdOrName - The layer ID or name\n   * @returns {Layer|null} The layer, or null if not found\n   */\n  getLayer(layerIdOrName) {\n    return this._getLayerById(layerIdOrName);\n  }\n\n  /**\n   * Gets all layers as an array, sorted by zIndex\n   * @returns {Layer[]} Array of layers\n   */\n  getLayers() {\n    return Array.from(this.layers.values()).sort((a, b) => a.zIndex - b.zIndex);\n  }\n\n  /**\n   * Gets layer information as plain objects\n   * @returns {Object[]} Array of layer info objects\n   */\n  getLayerInfo() {\n    return this.getLayers().map(layer => layer.toJSON());\n  }\n\n  /**\n   * Begins drawing to a specific layer\n   * @param {number|string} layerIdOrName - The ID or name of the layer to draw to\n   */\n  begin(layerIdOrName) {\n    // Check if another layer is already active\n    if (this.activeLayerId !== null) {\n      console.warn(`Layer ${this.activeLayerId} is already active. Ending it first.`);\n      this.end();\n    }\n\n    const layer = this._getLayerById(layerIdOrName);\n    if (!layer) {\n      console.error(`Layer ${layerIdOrName} not found`);\n      return;\n    }\n\n    layer.begin();\n    this.activeLayerId = layer.id;\n  }\n\n  /**\n   * Ends drawing to the current layer\n   */\n  end() {\n    if (this.activeLayerId === null) {\n      console.warn('No active layer to end');\n      return;\n    }\n\n    const layer = this.layers.get(this.activeLayerId);\n    if (layer) {\n      layer.end();\n\n      if (this.ui && typeof this.ui.scheduleThumbnailUpdate === 'function') {\n        this.ui.scheduleThumbnailUpdate(layer.id, { needsCapture: true });\n      }\n    }\n\n    this.activeLayerId = null;\n  }\n\n  /**\n   * Shows a layer (makes it visible)\n   * @param {number|string} layerIdOrName - The layer ID or name\n   * @returns {Layer|null} The layer for chaining, or null if not found\n   */\n  show(layerIdOrName) {\n    const layer = this._getLayerById(layerIdOrName);\n    if (!layer) {\n      console.warn(`Layer ${layerIdOrName} not found`);\n      return null;\n    }\n    return layer.show();\n  }\n\n  /**\n   * Hides a layer (makes it invisible)\n   * @param {number|string} layerIdOrName - The layer ID or name\n   * @returns {Layer|null} The layer for chaining, or null if not found\n   */\n  hide(layerIdOrName) {\n    const layer = this._getLayerById(layerIdOrName);\n    if (!layer) {\n      console.warn(`Layer ${layerIdOrName} not found`);\n      return null;\n    }\n    return layer.hide();\n  }\n\n  /**\n   * Sets the opacity of a layer\n   * @param {number|string} layerIdOrName - The layer ID or name\n   * @param {number} opacity - Opacity value between 0 and 1\n   * @returns {Layer|null} The layer for chaining, or null if not found\n   */\n  setOpacity(layerIdOrName, opacity) {\n    const layer = this._getLayerById(layerIdOrName);\n    if (!layer) {\n      console.warn(`Layer ${layerIdOrName} not found`);\n      return null;\n    }\n    return layer.setOpacity(opacity);\n  }\n\n  /**\n   * Sets the blend mode of a layer\n   * @param {number|string} layerIdOrName - The layer ID or name\n   * @param {string} blendMode - One of the BlendModes constants\n   * @returns {Layer|null} The layer for chaining, or null if not found\n   */\n  setBlendMode(layerIdOrName, blendMode) {\n    const layer = this._getLayerById(layerIdOrName);\n    if (!layer) {\n      console.warn(`Layer ${layerIdOrName} not found`);\n      return null;\n    }\n    return layer.setBlendMode(blendMode);\n  }\n\n  /**\n   * Sets the z-index of a layer\n   * @param {number|string} layerIdOrName - The layer ID or name\n   * @param {number} zIndex - The new z-index (higher = on top)\n   * @returns {Layer|null} The layer for chaining, or null if not found\n   */\n  setLayerIndex(layerIdOrName, zIndex) {\n    const layer = this._getLayerById(layerIdOrName);\n    if (!layer) {\n      console.warn(`Layer ${layerIdOrName} not found`);\n      return null;\n    }\n    return layer.setZIndex(zIndex);\n  }\n\n  /**\n   * Moves a layer by a relative amount in the stack\n   * @param {number|string} layerIdOrName - The layer ID or name\n   * @param {number} delta - The amount to move (positive = forward, negative = backward)\n   * @returns {Layer|null} The layer for chaining, or null if not found\n   */\n  moveLayer(layerIdOrName, delta) {\n    const layer = this._getLayerById(layerIdOrName);\n    if (!layer) {\n      console.warn(`Layer ${layerIdOrName} not found`);\n      return null;\n    }\n    return layer.setZIndex(layer.zIndex + delta);\n  }\n\n  /**\n   * Reorders layers to match a new array order\n   * @param {Layer[]} orderedLayers - Array of layers in the desired order\n   */\n  reorderLayers(orderedLayers) {\n    // Update zIndex for each layer based on its position in the array\n    orderedLayers.forEach((layer, index) => {\n      layer.setZIndex(index);\n    });\n  }\n\n  /**\n   * Attaches a mask to a layer\n   * @param {number|string} layerIdOrName - The layer ID or name\n   * @param {p5.Framebuffer|p5.Image} maskSource - The mask to apply\n   * @returns {Layer|null} The layer for chaining, or null if not found\n   */\n  setMask(layerIdOrName, maskSource) {\n    const layer = this._getLayerById(layerIdOrName);\n    if (!layer) {\n      console.warn(`Layer ${layerIdOrName} not found`);\n      return null;\n    }\n    return layer.setMask(maskSource);\n  }\n\n  /**\n   * Removes the mask from a layer\n   * @param {number|string} layerIdOrName - The layer ID or name\n   * @returns {Layer|null} The layer for chaining, or null if not found\n   */\n  clearMask(layerIdOrName) {\n    const layer = this._getLayerById(layerIdOrName);\n    if (!layer) {\n      console.warn(`Layer ${layerIdOrName} not found`);\n      return null;\n    }\n    return layer.clearMask();\n  }\n\n  /**\n   * Renders all layers to the main canvas\n   * @param {Function} clearCallback - Optional callback to clear the canvas before rendering\n   */\n  render(clearCallback = null) {\n    // Check for canvas resize\n    if (this.autoResize) {\n      this._checkResize();\n    }\n\n    const layers = this.getLayers();\n    this.compositor.render(layers, clearCallback);\n\n    // Sync UI state if UI exists\n    if (this.ui) {\n      this.ui.syncState();\n    }\n  }\n\n  /**\n   * Checks if canvas was resized and updates layers accordingly\n   * @private\n   */\n  _checkResize() {\n    const currentWidth = this.p.width;\n    const currentHeight = this.p.height;\n    const currentDensity = this.p.pixelDensity();\n\n    const sizeChanged = currentWidth !== this._lastCanvasWidth ||\n      currentHeight !== this._lastCanvasHeight;\n    const densityChanged = currentDensity !== this._lastPixelDensity;\n\n    if (!sizeChanged && !densityChanged) {\n      return;\n    }\n\n    this._lastCanvasWidth = currentWidth;\n    this._lastCanvasHeight = currentHeight;\n    this._lastPixelDensity = currentDensity;\n\n    // Resize all canvas-synced layers\n    for (const layer of this.layers.values()) {\n      if (!layer.customSize) {\n        layer.resize(currentWidth, currentHeight, currentDensity);\n      }\n    }\n  }\n\n  /**\n   * Enables or disables automatic layer resizing when canvas size changes\n   * @param {boolean} enabled - Whether to enable auto-resize\n   */\n  setAutoResize(enabled) {\n    this.autoResize = !!enabled;\n  }\n\n  /**\n   * Creates and shows a UI panel for controlling layers\n   * @param {Object} options - UI configuration options\n   * @returns {LayerUI} The created UI instance\n   */\n  createUI(options = {}) {\n    // Dispose existing UI if any\n    if (this.ui) {\n      this.ui.dispose();\n    }\n\n    this.ui = new LayerUI(this, options);\n    this.ui.update();\n    return this.ui;\n  }\n\n  /**\n   * Updates the UI if it exists\n   */\n  updateUI() {\n    if (this.ui) {\n      this.ui.update();\n    }\n  }\n\n  /**\n   * Disposes of all layers and resources\n   */\n  dispose() {\n    // End active layer if any\n    if (this.activeLayerId !== null) {\n      this.end();\n    }\n\n    // Dispose UI if exists\n    if (this.ui) {\n      this.ui.dispose();\n      this.ui = null;\n    }\n\n    // Dispose all layers\n    for (const layer of this.layers.values()) {\n      layer.dispose();\n    }\n\n    this.layers.clear();\n    this.compositor.dispose();\n  }\n}\n","/**\n * p5.millefeuille - A Photoshop-like layer system for p5.js WebGL\n *\n * @module p5.millefeuille\n */\n\nimport { LayerSystem } from './LayerSystem.js';\nimport { BlendModes as BlendModesEnum } from './constants.js';\n\nexport { Layer } from './Layer.js';\nexport { Compositor } from './Compositor.js';\nexport { LayerUI } from './LayerUI.js';\nexport { BlendModes, getBlendModeIndex, DEFAULT_LAYER_OPTIONS } from './constants.js';\n\n// Version\nexport const VERSION = '0.1.0';\n\n/**\n * p5.js addon registration function\n * @param {object} p5 - The p5 constructor\n * @param {object} fn - The p5 prototype\n * @param {object} lifecycles - Lifecycle hooks\n */\nfunction millefeuilleAddon(p5, fn, lifecycles) {\n  // Attach createLayerSystem to p5 prototype\n  fn.createLayerSystem = function(options = {}) {\n    // 'this' is the p5 instance\n    return new LayerSystem(this, options);\n  };\n\n  // Cleanup lifecycle - dispose layer system when sketch is removed\n  if (lifecycles) {\n    lifecycles.remove = function() {\n      if (this._layerSystem) {\n        this._layerSystem.dispose();\n        this._layerSystem = null;\n      }\n    };\n  }\n}\n\n// Auto-register for script tag usage\nif (typeof window !== 'undefined' && typeof window.p5 !== 'undefined') {\n  window.p5.registerAddon(millefeuilleAddon);\n  \n  // Also expose common utilities globally for convenience\n  window.BlendModes = BlendModesEnum;\n}\n\n// Export addon function as default for ESM usage\nexport default millefeuilleAddon;\n\n// Also export LayerSystem for direct instantiation if needed\nexport { LayerSystem };\n"],"names":["BlendModesEnum"],"mappings":"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AAE;AACzD,MAAM;AACN,IAAI;;AAEJ,IAAI,MAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC;AACjD,IAAI,KAAK,CAAC,EAAE,GAAG,sBAAsB;AACrC,IAAI,KAAK,CAAC,WAAW,GAAG;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI,CAAC;;AAEL,IAAI,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;AACpC,EAAE;;AAEF;AACA;AACA;AACA,EAAE,MAAM,GAAG;AACX,IAAI,IAAI,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,WAAW;AACxC,IAAI,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC;;AAElE,IAAI,MAAM,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,oBAAoB,CAAC;AAClE,IAAI,IAAI,GAAG,EAAE;AACb,MAAM,GAAG,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,GAAG,GAAG,GAAG,GAAG;AAClD,IAAI;AACJ,EAAE;;AAEF;AACA;AACA;AACA,EAAE,IAAI,GAAG;AACT,IAAI,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO;AAC1C,EAAE;;AAEF;AACA;AACA;AACA,EAAE,IAAI,GAAG;AACT,IAAI,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM;AACzC,EAAE;;AAEF;AACA;AACA;AACA,EAAE,OAAO,GAAG;AACZ,IAAI,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE;AACrD,MAAM,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;AAC3D,IAAI;;AAEJ,IAAI,IAAI,IAAI,CAAC,qBAAqB,IAAI,IAAI,CAAC,qBAAqB,KAAK,IAAI,EAAE;AAC3E,MAAM,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,qBAAqB,CAAC;AAC5D,IAAI;AACJ,IAAI,IAAI,CAAC,uBAAuB,CAAC,KAAK,EAAE;AACxC,IAAI,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE;AAC/B,IAAI,IAAI,CAAC,eAAe,CAAC,KAAK,EAAE;AAChC,IAAI,IAAI,CAAC,qBAAqB,GAAG,IAAI;AACrC,IAAI,IAAI,CAAC,qBAAqB,GAAG,IAAI;AACrC,IAAI,IAAI,CAAC,uBAAuB,GAAG,IAAI;AACvC,IAAI,IAAI,CAAC,oBAAoB,GAAG,IAAI;AACpC,EAAE;AACF;;ACthDA;AACA;AACA;AACO,MAAM,WAAW,CAAC;AACzB;AACA;AACA;AACA,EAAE,WAAW,CAAC,UAAU,EAAE;AAC1B,IAAI,IAAI,CAAC,CAAC,GAAG,UAAU;;AAEvB;AACA,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,cAAc,EAAE;AAC/D,MAAM,MAAM,IAAI,KAAK,CAAC,uFAAuF,CAAC;AAC9G,IAAI;;AAEJ,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,cAAc,YAAY,qBAAqB;AACxE,QAAQ,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,cAAc,YAAY,sBAAsB,EAAE,CAEtE,MAAM;AACX,MAAM,MAAM,IAAI,KAAK,CAAC,gEAAgE,CAAC;AACvF,IAAI;;AAEJ,IAAI,IAAI,CAAC,MAAM,GAAG,IAAI,GAAG,EAAE,CAAC;AAC5B,IAAI,IAAI,CAAC,UAAU,GAAG,IAAI,GAAG,EAAE,CAAC;AAChC,IAAI,IAAI,CAAC,cAAc,GAAG,CAAC;AAC3B,IAAI,IAAI,CAAC,aAAa,GAAG,IAAI;AAC7B,IAAI,IAAI,CAAC,UAAU,GAAG,IAAI,UAAU,CAAC,UAAU,CAAC;AAChD,IAAI,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC;;AAEnB;AACA,IAAI,IAAI,CAAC,UAAU,GAAG,IAAI;AAC1B,IAAI,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,CAAC,CAAC,KAAK;AACxC,IAAI,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,CAAC,CAAC,MAAM;AAC1C,IAAI,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,CAAC,CAAC,YAAY,EAAE;AAClD,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE,WAAW,GAAG;AAChB,IAAI,OAAO,IAAI,CAAC,cAAc,EAAE;AAChC,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,aAAa,CAAC,aAAa,EAAE;AAC/B;AACA,IAAI,IAAI,OAAO,aAAa,KAAK,QAAQ,EAAE;AAC3C,MAAM,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,IAAI;AACnD,IAAI;AACJ;AACA;AACA,IAAI,IAAI,OAAO,aAAa,KAAK,QAAQ,EAAE;AAC3C,MAAM,MAAM,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,aAAa,CAAC;AACnD,MAAM,IAAI,EAAE,KAAK,SAAS,EAAE;AAC5B,QAAQ,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,IAAI;AAC1C,MAAM;AACN,IAAI;AACJ;AACA,IAAI,OAAO,IAAI;AACf,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,WAAW,CAAC,IAAI,GAAG,EAAE,EAAE,OAAO,GAAG,EAAE,EAAE;AACvC,IAAI,MAAM,EAAE,GAAG,IAAI,CAAC,WAAW,EAAE;AACjC,IAAI,MAAM,SAAS,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;AAC3C,IAAI,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,EAAE,SAAS,EAAE;AACnD,MAAM,GAAG,OAAO;AAChB,MAAM,MAAM,EAAE,OAAO,CAAC,MAAM,KAAK,SAAS,GAAG,OAAO,CAAC,MAAM,GAAG;AAC9D,KAAK,CAAC;;AAEN,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,EAAE,KAAK,CAAC;AAC9B;AACA;AACA,IAAI,IAAI,SAAS,EAAE;AACnB,MAAM,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,CAAC;AACxC,IAAI;AACJ;AACA,IAAI,OAAO,KAAK;AAChB,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE,WAAW,CAAC,aAAa,EAAE;AAC7B,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AACnD,IAAI,IAAI,CAAC,KAAK,EAAE;AAChB,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;AACtD,MAAM;AACN,IAAI;;AAEJ;AACA,IAAI,IAAI,IAAI,CAAC,aAAa,KAAK,KAAK,CAAC,EAAE,EAAE;AACzC,MAAM,IAAI,CAAC,GAAG,EAAE;AAChB,IAAI;;AAEJ;AACA,IAAI,IAAI,KAAK,CAAC,IAAI,EAAE;AACpB,MAAM,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC;AACxC,IAAI;;AAEJ,IAAI,KAAK,CAAC,OAAO,EAAE;AACnB,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC;AAChC,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,EAAE,QAAQ,CAAC,aAAa,EAAE;AAC1B,IAAI,OAAO,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AAC5C,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE,SAAS,GAAG;AACd,IAAI,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC;AAC/E,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE,YAAY,GAAG;AACjB,IAAI,OAAO,IAAI,CAAC,SAAS,EAAE,CAAC,GAAG,CAAC,KAAK,IAAI,KAAK,CAAC,MAAM,EAAE,CAAC;AACxD,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE,KAAK,CAAC,aAAa,EAAE;AACvB;AACA,IAAI,IAAI,IAAI,CAAC,aAAa,KAAK,IAAI,EAAE;AACrC,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,IAAI,CAAC,aAAa,CAAC,oCAAoC,CAAC,CAAC;AACrF,MAAM,IAAI,CAAC,GAAG,EAAE;AAChB,IAAI;;AAEJ,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AACnD,IAAI,IAAI,CAAC,KAAK,EAAE;AAChB,MAAM,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;AACvD,MAAM;AACN,IAAI;;AAEJ,IAAI,KAAK,CAAC,KAAK,EAAE;AACjB,IAAI,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC,EAAE;AACjC,EAAE;;AAEF;AACA;AACA;AACA,EAAE,GAAG,GAAG;AACR,IAAI,IAAI,IAAI,CAAC,aAAa,KAAK,IAAI,EAAE;AACrC,MAAM,OAAO,CAAC,IAAI,CAAC,wBAAwB,CAAC;AAC5C,MAAM;AACN,IAAI;;AAEJ,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC;AACrD,IAAI,IAAI,KAAK,EAAE;AACf,MAAM,KAAK,CAAC,GAAG,EAAE;;AAEjB,MAAM,IAAI,IAAI,CAAC,EAAE,IAAI,OAAO,IAAI,CAAC,EAAE,CAAC,uBAAuB,KAAK,UAAU,EAAE;AAC5E,QAAQ,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,KAAK,CAAC,EAAE,EAAE,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC;AACzE,MAAM;AACN,IAAI;;AAEJ,IAAI,IAAI,CAAC,aAAa,GAAG,IAAI;AAC7B,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,EAAE,IAAI,CAAC,aAAa,EAAE;AACtB,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AACnD,IAAI,IAAI,CAAC,KAAK,EAAE;AAChB,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;AACtD,MAAM,OAAO,IAAI;AACjB,IAAI;AACJ,IAAI,OAAO,KAAK,CAAC,IAAI,EAAE;AACvB,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,EAAE,IAAI,CAAC,aAAa,EAAE;AACtB,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AACnD,IAAI,IAAI,CAAC,KAAK,EAAE;AAChB,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;AACtD,MAAM,OAAO,IAAI;AACjB,IAAI;AACJ,IAAI,OAAO,KAAK,CAAC,IAAI,EAAE;AACvB,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,UAAU,CAAC,aAAa,EAAE,OAAO,EAAE;AACrC,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AACnD,IAAI,IAAI,CAAC,KAAK,EAAE;AAChB,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;AACtD,MAAM,OAAO,IAAI;AACjB,IAAI;AACJ,IAAI,OAAO,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC;AACpC,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,YAAY,CAAC,aAAa,EAAE,SAAS,EAAE;AACzC,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AACnD,IAAI,IAAI,CAAC,KAAK,EAAE;AAChB,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;AACtD,MAAM,OAAO,IAAI;AACjB,IAAI;AACJ,IAAI,OAAO,KAAK,CAAC,YAAY,CAAC,SAAS,CAAC;AACxC,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,aAAa,CAAC,aAAa,EAAE,MAAM,EAAE;AACvC,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AACnD,IAAI,IAAI,CAAC,KAAK,EAAE;AAChB,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;AACtD,MAAM,OAAO,IAAI;AACjB,IAAI;AACJ,IAAI,OAAO,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC;AAClC,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,SAAS,CAAC,aAAa,EAAE,KAAK,EAAE;AAClC,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AACnD,IAAI,IAAI,CAAC,KAAK,EAAE;AAChB,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;AACtD,MAAM,OAAO,IAAI;AACjB,IAAI;AACJ,IAAI,OAAO,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC;AAChD,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE,aAAa,CAAC,aAAa,EAAE;AAC/B;AACA,IAAI,aAAa,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,KAAK,KAAK;AAC5C,MAAM,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC;AAC5B,IAAI,CAAC,CAAC;AACN,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,OAAO,CAAC,aAAa,EAAE,UAAU,EAAE;AACrC,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AACnD,IAAI,IAAI,CAAC,KAAK,EAAE;AAChB,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;AACtD,MAAM,OAAO,IAAI;AACjB,IAAI;AACJ,IAAI,OAAO,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC;AACpC,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,EAAE,SAAS,CAAC,aAAa,EAAE;AAC3B,IAAI,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC;AACnD,IAAI,IAAI,CAAC,KAAK,EAAE;AAChB,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC;AACtD,MAAM,OAAO,IAAI;AACjB,IAAI;AACJ,IAAI,OAAO,KAAK,CAAC,SAAS,EAAE;AAC5B,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE,MAAM,CAAC,aAAa,GAAG,IAAI,EAAE;AAC/B;AACA,IAAI,IAAI,IAAI,CAAC,UAAU,EAAE;AACzB,MAAM,IAAI,CAAC,YAAY,EAAE;AACzB,IAAI;;AAEJ,IAAI,MAAM,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE;AACnC,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,EAAE,aAAa,CAAC;;AAEjD;AACA,IAAI,IAAI,IAAI,CAAC,EAAE,EAAE;AACjB,MAAM,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE;AACzB,IAAI;AACJ,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE,YAAY,GAAG;AACjB,IAAI,MAAM,YAAY,GAAG,IAAI,CAAC,CAAC,CAAC,KAAK;AACrC,IAAI,MAAM,aAAa,GAAG,IAAI,CAAC,CAAC,CAAC,MAAM;AACvC,IAAI,MAAM,cAAc,GAAG,IAAI,CAAC,CAAC,CAAC,YAAY,EAAE;;AAEhD,IAAI,MAAM,WAAW,GAAG,YAAY,KAAK,IAAI,CAAC,gBAAgB;AAC9D,MAAM,aAAa,KAAK,IAAI,CAAC,iBAAiB;AAC9C,IAAI,MAAM,cAAc,GAAG,cAAc,KAAK,IAAI,CAAC,iBAAiB;;AAEpE,IAAI,IAAI,CAAC,WAAW,IAAI,CAAC,cAAc,EAAE;AACzC,MAAM;AACN,IAAI;;AAEJ,IAAI,IAAI,CAAC,gBAAgB,GAAG,YAAY;AACxC,IAAI,IAAI,CAAC,iBAAiB,GAAG,aAAa;AAC1C,IAAI,IAAI,CAAC,iBAAiB,GAAG,cAAc;;AAE3C;AACA,IAAI,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,EAAE;AAC9C,MAAM,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE;AAC7B,QAAQ,KAAK,CAAC,MAAM,CAAC,YAAY,EAAE,aAAa,EAAE,cAAc,CAAC;AACjE,MAAM;AACN,IAAI;AACJ,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE,aAAa,CAAC,OAAO,EAAE;AACzB,IAAI,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC,OAAO;AAC/B,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,EAAE,QAAQ,CAAC,OAAO,GAAG,EAAE,EAAE;AACzB;AACA,IAAI,IAAI,IAAI,CAAC,EAAE,EAAE;AACjB,MAAM,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE;AACvB,IAAI;;AAEJ,IAAI,IAAI,CAAC,EAAE,GAAG,IAAI,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC;AACxC,IAAI,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE;AACpB,IAAI,OAAO,IAAI,CAAC,EAAE;AAClB,EAAE;;AAEF;AACA;AACA;AACA,EAAE,QAAQ,GAAG;AACb,IAAI,IAAI,IAAI,CAAC,EAAE,EAAE;AACjB,MAAM,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE;AACtB,IAAI;AACJ,EAAE;;AAEF;AACA;AACA;AACA,EAAE,OAAO,GAAG;AACZ;AACA,IAAI,IAAI,IAAI,CAAC,aAAa,KAAK,IAAI,EAAE;AACrC,MAAM,IAAI,CAAC,GAAG,EAAE;AAChB,IAAI;;AAEJ;AACA,IAAI,IAAI,IAAI,CAAC,EAAE,EAAE;AACjB,MAAM,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE;AACvB,MAAM,IAAI,CAAC,EAAE,GAAG,IAAI;AACpB,IAAI;;AAEJ;AACA,IAAI,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,EAAE;AAC9C,MAAM,KAAK,CAAC,OAAO,EAAE;AACrB,IAAI;;AAEJ,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;AACvB,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE;AAC7B,EAAE;AACF;;ACpaA;AACA;AACA;AACA;AACA;;;AAUA;AACY,MAAC,OAAO,GAAG;;AAEvB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,iBAAiB,CAAC,EAAE,EAAE,EAAE,EAAE,UAAU,EAAE;AAC/C;AACA,EAAE,EAAE,CAAC,iBAAiB,GAAG,SAAS,OAAO,GAAG,EAAE,EAAE;AAChD;AACA,IAAI,OAAO,IAAI,WAAW,CAAC,IAAI,EAAE,OAAO,CAAC;AACzC,EAAE,CAAC;;AAEH;AACA,EAAE,IAAI,UAAU,EAAE;AAClB,IAAI,UAAU,CAAC,MAAM,GAAG,WAAW;AACnC,MAAM,IAAI,IAAI,CAAC,YAAY,EAAE;AAC7B,QAAQ,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE;AACnC,QAAQ,IAAI,CAAC,YAAY,GAAG,IAAI;AAChC,MAAM;AACN,IAAI,CAAC;AACL,EAAE;AACF;;AAEA;AACA,IAAI,OAAO,MAAM,KAAK,WAAW,IAAI,OAAO,MAAM,CAAC,EAAE,KAAK,WAAW,EAAE;AACvE,EAAE,MAAM,CAAC,EAAE,CAAC,aAAa,CAAC,iBAAiB,CAAC;AAC5C;AACA;AACA,EAAE,MAAM,CAAC,UAAU,GAAGA,UAAc;AACpC;;;;"}