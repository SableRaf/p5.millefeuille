let ls,redGradient,greenGradient,blueGradient,backgroundGraphic,blendModeSelect;function createGradientEllipse(e,t,n,l="gradientEllipse"){const o=createElement("canvas"),a=createGraphics(t,n,o.elt);o.attribute("id",l),o.attribute("class","p5.Graphics"),o.attribute("width",t),o.attribute("height",n);const r=a.drawingContext,d=r.createLinearGradient(0,n/2,t,n/2);return d.addColorStop(0,`rgb(${e[0]}, ${e[1]}, ${e[2]})`),d.addColorStop(1,"rgb(255, 255, 255)"),r.fillStyle=d,a.noStroke(),a.ellipse(t/2,n/2,t,n),a}function createBackgroundGradient(e,t){const n=createGraphics(e,t,WEBGL),l=n.createShader("\n    attribute vec3 aPosition;\n    attribute vec2 aTexCoord;\n    varying vec2 vTexCoord;\n    void main() {\n      vTexCoord = aTexCoord;\n      vec4 positionVec4 = vec4(aPosition, 1.0);\n      positionVec4.xy = positionVec4.xy * 2.0 - 1.0;\n      gl_Position = positionVec4;\n    }\n  ","\n    precision mediump float;\n    varying vec2 vTexCoord;\n\n    vec3 mix3(vec3 a, vec3 b, float t) {\n      return a + (b - a) * t;\n    }\n\n    void main() {\n      vec2 uv = vTexCoord;\n\n      // Vertical gradient: yellow -> magenta -> cyan\n      vec3 yellow = vec3(1.0, 1.0, 0.0);\n      vec3 magenta = vec3(1.0, 0.0, 1.0);\n      vec3 cyan = vec3(0.0, 1.0, 1.0);\n\n      vec3 vertColor;\n      if (uv.y < 0.5) {\n        // yellow to magenta\n        float t = uv.y * 2.0;\n        vertColor = mix3(yellow, magenta, t);\n      } else {\n        // magenta to cyan\n        float t = (uv.y - 0.5) * 2.0;\n        vertColor = mix3(magenta, cyan, t);\n      }\n\n      // Horizontal gradient overlay (black to normal to white)\n      vec3 finalColor;\n      if (uv.x < 0.5) {\n        // Mix with black\n        float t = uv.x * 2.0;\n        finalColor = mix3(vec3(0.0), vertColor, t);\n      } else {\n        // Mix with white\n        float t = (uv.x - 0.5) * 2.0;\n        finalColor = mix3(vertColor, vec3(1.0), t);\n      }\n\n      gl_FragColor = vec4(finalColor, 1.0);\n    }\n  ");return n.shader(l),n.noStroke(),n.rect(-e/2,-t/2,e,t),n}function createBlendModeSelect(e){const t=createDiv();t.style("margin","16px"),t.style("padding","12px 16px"),t.style("background","rgba(255, 255, 255, 0.08)"),t.style("border-radius","8px"),t.style("display","inline-flex"),t.style("align-items","center"),t.style("gap","12px"),t.parent(select(".info"));const n=createSpan("Set blend mode globally");function l(e){e.style("background","rgba(0, 0, 0, 0.4)"),e.style("border","1px solid rgba(255, 255, 255, 0.2)"),e.style("border-radius","6px"),e.style("color","#e8e8e8"),e.style("width","32px"),e.style("height","34px"),e.style("font-size","14px"),e.style("cursor","pointer"),e.style("transition","all 0.15s")}n.style("font-weight","600"),n.style("color","#e8e8e8"),n.style("font-size","14px"),n.parent(t);const o=createButton("◀");o.parent(t),l(o),blendModeSelect=createSelect(),blendModeSelect.parent(t),blendModeSelect.style("background","rgba(0, 0, 0, 0.4)"),blendModeSelect.style("border","1px solid rgba(255, 255, 255, 0.2)"),blendModeSelect.style("border-radius","6px"),blendModeSelect.style("color","#e8e8e8"),blendModeSelect.style("padding","8px 12px"),blendModeSelect.style("font-size","14px"),blendModeSelect.style("cursor","pointer"),blendModeSelect.style("outline","none"),blendModeSelect.style("min-width","140px"),blendModeSelect.style("appearance","none"),blendModeSelect.style("background-image","url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23e8e8e8' width='24px' height='24px'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E\")"),blendModeSelect.style("background-repeat","no-repeat"),blendModeSelect.style("background-position","right 8px center"),blendModeSelect.style("background-size","16px 16px");const a=createButton("▶");a.parent(t),l(a);const r=Object.keys(BlendModes);function d(e){ls.setBlendMode("Red Ellipse",e),ls.setBlendMode("Green Ellipse",e),ls.setBlendMode("Blue Ellipse",e),ls.ui.syncState()}r.forEach(e=>{const t=e.split("_").map(e=>e.charAt(0)+e.slice(1).toLowerCase()).join(" ");blendModeSelect.option(t,BlendModes[e])}),blendModeSelect.changed(()=>{d(blendModeSelect.value())}),o.mousePressed(()=>{const e=(r.findIndex(e=>BlendModes[e]===blendModeSelect.value())-1+r.length)%r.length;blendModeSelect.selected(BlendModes[r[e]]),d(blendModeSelect.value())}),a.mousePressed(()=>{const e=(r.findIndex(e=>BlendModes[e]===blendModeSelect.value())+1)%r.length;blendModeSelect.selected(BlendModes[r[e]]),d(blendModeSelect.value())})}window.setup=function(){createCanvas(600,600,WEBGL),backgroundGraphic=createBackgroundGradient(600,600),redGradient=createGradientEllipse([255,0,0],200,560,"redEllipse"),greenGradient=createGradientEllipse([0,255,0],200,560,"greenEllipse"),blueGradient=createGradientEllipse([0,0,255],200,560,"blueEllipse"),ls=createLayerSystem(),ls.createLayer("Background"),ls.createLayer("Red Ellipse").setBlendMode(BlendModes.NORMAL),ls.createLayer("Green Ellipse").setBlendMode(BlendModes.NORMAL),ls.createLayer("Blue Ellipse").setBlendMode(BlendModes.NORMAL),ls.createUI(),createBlendModeSelect(ls)},window.draw=function(){ls.begin("Background"),clear(),push(),imageMode(CENTER),image(backgroundGraphic,0,0),pop(),ls.end(),ls.begin("Red Ellipse"),clear(),push(),rotate(radians(30)),imageMode(CENTER),image(redGradient,0,0),pop(),ls.end(),ls.begin("Green Ellipse"),clear(),push(),rotate(radians(90)),imageMode(CENTER),image(greenGradient,0,0),pop(),ls.end(),ls.begin("Blue Ellipse"),clear(),push(),rotate(radians(150)),imageMode(CENTER),image(blueGradient,0,0),pop(),ls.end(),ls.render()};